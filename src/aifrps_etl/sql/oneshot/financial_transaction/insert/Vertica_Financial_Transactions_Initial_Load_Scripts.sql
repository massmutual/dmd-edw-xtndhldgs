/*--------------Insert script to load from temp to core table for RPS FFD---------------------*/

INSERT INTO edw_financial_transactions.fact_financial_detail
(
 fact_financial_detail_natural_key_hash_uuid,
 dim_financial_transaction_natural_key_hash_uuid,
 calendar_dt,
 transaction_detail_type_cde,
 transaction_detail_category_cde,
 transaction_detail_method_cde,
 source_transaction_detail_category_cde,
 source_transaction_detail_method_cde,
 source_transaction_detail_type_cde,
 transaction_amt,
 row_process_dtm,
 audit_id,
 logical_delete_ind,
 check_sum,
 source_system_id,
 restricted_row_ind,
 update_audit_id,
 source_delete_ind,
 credit_debit_type_cde,
 source_credit_debit_type_cde,
 transaction_sequence_nr,
 waiver_reason_cde,
 source_waiver_reason_cde,
 money_source_cde,
 source_money_source_cde,
 bill_mode_cde,
 source_bill_mode_cde,
 premium_paid_dt,
 premium_due_dt,
 transaction_duration_nr,
 deposits_tax_year_nr,
 fund_units_cnt,
 fund_unit_val_rt,
 fund_declared_interest_rt,
 basis_points_val,
 commission_overdue_pct,
 bonus_rt,
 post_tefra_cost_basis_amt,
 pre_tefra_cost_basis_amt,
 rollover_amt,
 new_money_amt,
 exchange_1035_amt,
 transfer_amt,
 premium_due_amt,
 interest_due_amt,
 premium_payment_cash_amt,
 waiver_premium_payment_cash_amt,
 premium_payment_loan_amt,
 premium_payment_dividend_amt,
 premium_payment_abr_dividend_amt
)
SELECT
fact_financial_detail_natural_key_hash_uuid,
 dim_financial_transaction_natural_key_hash_uuid,
 calendar_dt,
 transaction_detail_type_cde,
 transaction_detail_category_cde,
 transaction_detail_method_cde,
 source_transaction_detail_category_cde,
 source_transaction_detail_method_cde,
 source_transaction_detail_type_cde,
 transaction_amt,
 row_process_dtm,
 audit_id,
 logical_delete_ind,
 check_sum,
 source_system_id,
 restricted_row_ind,
 update_audit_id,
 source_delete_ind,
 credit_debit_type_cde,
 source_credit_debit_type_cde,
 transaction_sequence_nr,
 waiver_reason_cde,
 source_waiver_reason_cde,
 money_source_cde,
 source_money_source_cde,
 bill_mode_cde,
 source_bill_mode_cde,
 premium_paid_dt,
 premium_due_dt,
 transaction_duration_nr,
 deposits_tax_year_nr,
 fund_units_cnt,
 fund_unit_val_rt,
 fund_declared_interest_rt,
 basis_points_val,
 commission_overdue_pct,
 bonus_rt,
 post_tefra_cost_basis_amt,
 pre_tefra_cost_basis_amt,
 rollover_amt,
 new_money_amt,
 exchange_1035_amt,
 transfer_amt,
 premium_due_amt,
 interest_due_amt,
 premium_payment_cash_amt,
 waiver_premium_payment_cash_amt,
 premium_payment_loan_amt,
 premium_payment_dividend_amt,
 premium_payment_abr_dividend_amt
 FROM edw_work.fact_financial_detail_aifrps
 where source_system_id=266;

/*--------------Insert script to load from temp to core table  for RPS RFT---------------------*/

INSERT INTO edw_financial_transactions.rel_financial_transaction
(
 dim_financial_transaction_natural_key_hash_uuid,
 dim_party_natural_key_hash_uuid,
 dim_agreement_natural_key_hash_uuid,
 begin_dt,
 begin_dtm,
 row_process_dtm,
 audit_id,
 logical_delete_ind,
 check_sum,
 current_row_ind,
 end_dt,
 end_dtm,
 source_system_id,
 restricted_row_ind,
 update_audit_id,
 source_delete_ind,
 dim_fund_natural_key_hash_uuid
)
select 
dim_financial_transaction_natural_key_hash_uuid,
 dim_party_natural_key_hash_uuid,
 dim_agreement_natural_key_hash_uuid,
 begin_dt,
 begin_dtm,
 row_process_dtm,
 audit_id,
 logical_delete_ind,
 check_sum,
 current_row_ind,
 end_dt,
 end_dtm,
 source_system_id,
 restricted_row_ind,
 update_audit_id,
 source_delete_ind,
 dim_fund_natural_key_hash_uuid
 from edw_work.rel_financial_transaction_aifrps
 where source_system_id=266;
 
 /*--------------Insert script to load from temp to core table for RPS DFT---------------------*/

INSERT INTO edw_financial_transactions.dim_financial_transaction 
(
 dim_financial_transaction_natural_key_hash_uuid,
 financial_transaction_unique_id,
 ref_financial_transaction_source_natural_key_hash_uuid,
 ref_financial_transaction_type_natural_key_hash_uuid,
 pay_group_nr_txt,
 check_form_id,
 transaction_dt,
 check_status_cde,
 account_nr_txt,
 tax_reporting_cde,
 original_check_nr,
 distribution_cde,
 source_payee_unique_id,
 clear_dt,
 clear_reference_nr_txt,
 reversal_dt,
 begin_dt,
 begin_dtm,
 row_process_dtm,
 audit_id,
 logical_delete_ind,
 check_sum,
 current_row_ind,
 end_dt,
 end_dtm,
 source_system_id,
 restricted_row_ind,
 update_audit_id,
 source_delete_ind,
 source_transaction_key_txt,
 routing_nr_txt,
 payment_method_cde,
 previous_source_transaction_key_txt,
 effective_dt,
 system_dt,
 transaction_cde,
 source_transaction_cde,
 transaction_reversal_cde,
 admin_fund_cde,
 product_id,
 company_cde,
 source_company_cde,
 pt1_kind_cde,
 product_tier_cde,
 fund_type_cde,
 source_fund_type_cde,
 coverage_type_cde,
 coverage_occurance_nr,
 transaction_source_id,
 transaction_memo_cde,
 rollover_cde,
 source_rollover_cde,
 gmib_status_cde,
 administration_cde,
 source_administration_cde,
 disbursement_transaction_nr_txt,
 replacement_transaction_nr_txt,
 transaction_desc,
 source_transaction_desc,
 transaction_reporting_desc,
 transaction_reporting_detail_desc
)
SELECT
 dim_financial_transaction_natural_key_hash_uuid,
 financial_transaction_unique_id,
 ref_financial_transaction_source_natural_key_hash_uuid,
 ref_financial_transaction_type_natural_key_hash_uuid,
 pay_group_nr_txt,
 check_form_id,
 transaction_dt,
 check_status_cde,
 account_nr_txt,
 tax_reporting_cde,
 original_check_nr,
 distribution_cde,
 source_payee_unique_id,
 clear_dt,
 clear_reference_nr_txt,
 reversal_dt,
 begin_dt,
 begin_dtm,
 row_process_dtm,
 audit_id,
 logical_delete_ind,
 check_sum,
 current_row_ind,
 end_dt,
 end_dtm,
 source_system_id,
 restricted_row_ind,
 update_audit_id,
 source_delete_ind,
 source_transaction_key_txt,
 routing_nr_txt,
 payment_method_cde,
 previous_source_transaction_key_txt,
 effective_dt,
 system_dt,
 transaction_cde,
 source_transaction_cde,
 transaction_reversal_cde,
 admin_fund_cde,
 product_id,
 company_cde,
 source_company_cde,
 pt1_kind_cde,
 product_tier_cde,
 fund_type_cde,
 source_fund_type_cde,
 coverage_type_cde,
 coverage_occurance_nr,
 transaction_source_id,
 transaction_memo_cde,
 rollover_cde,
 source_rollover_cde,
 gmib_status_cde,
 administration_cde,
 source_administration_cde,
 disbursement_transaction_nr_txt,
 replacement_transaction_nr_txt,
 transaction_desc,
 source_transaction_desc,
 transaction_reporting_desc,
 transaction_reporting_detail_desc
 from edw_work.dim_financial_transaction_aifrps
 where source_system_id=266;
 
 commit;