/*
		FILENAME:       aifrps_attr_agreement_values.sql
		AUTHOR:         Saiprasad M / Srini R
		SUBJECT AREA :  AGREEMENT
		SOURCE:         AIF - RPS
		TERADATA SOURCE CODE: 72
		DESCRIPTION:    ATTR_AGREEMENT_VALUES TABLE POPULATION

		===============================================================================================================
		VERSION/JIRA STORY#			CREATED BY          LAST_MODIFIED_DATE		DESCRIPTION
		---------------------------------------------------------------------------------------------------------------
		JIRA# TERSUN-####           MM23717 / CP45213                 07/05/2021			FIRST VERSION OF Initial_Load FOR TIER-2
		
		---------------------------------------------------------------------------------------------------------------
*/



/* TRUNCATE STAGING PRE WORK TABLE */
TRUNCATE TABLE edw_staging.aifrps_attr_agreement_values_pre_work;

/*TRUNCATE WORK TABLE */
TRUNCATE TABLE edw_work.aifrps_attr_agreement_values;


/*INSERT SCRIPT FOR PRE WORK TABLE -ALL RECORDS FROM STG*/
--STEP1-> edw_staging.source => edw_staging.pre_work, business logic done here.

INSERT INTO edw_staging.aifrps_attr_agreement_values_pre_work
(
DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
AGREEMENT_VAL_AS_OF_DT,
TOTAL_CONTRIBUTION_AMT,
TOTAL_CONTRIBUTION_QUALITY_CDE,
NET_DEATH_BENEFIT_AMT,
NET_DEATH_BENEFIT_QUALITY_CDE,
NET_DEATH_BENEFIT_DT,
NET_CASH_VAL_AMT,
NET_CASH_VAL_QUALITY_CDE,
TOTAL_ACCOUNT_VAL_AMT,
TOTAL_ACCOUNT_VAL_QUALITY_CDE,
GROSS_CASH_VAL_AMT,
GROSS_CASH_VAL_QUALITY_CDE,
SURRENDER_CHARGE_AMT,
SURRENDER_CHARGE_QUALITY_CDE,
GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
DEFICIENCY_AMT,
DEFICIENCY_QUALITY_CDE,
LOW_DEATH_BENEFIT_AMT,
LOW_DEATH_BENEFIT_QUALITY_CDE,
EXCHANGE_1035_AMT,
EXCHANGE_1035_QUALITY_CDE,
EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
TERM_RIDER_COVERAGE_AMT,
TERM_RIDER_COVERAGE_QUALITY_CDE,
DAY_OLD_IND,
SOURCE_DAY_OLD_IND,
ARREARS_INTEREST_CREDIT_AMT,
ARREARS_INTEREST_PAID_AMT,
MINIMUM_CASH_REQUIRED_AMT,
MINIMUM_CASH_REQUIRED_QUALITY_CDE,
NET_DUE_AMT,
NET_DUE_QUALITY_CDE,
GROSS_DEATH_BENEFIT_AMT,
GROSS_DEATH_BENEFIT_QUALITY_CDE,
CONTRACT_VAL_AMT,
CONTRACT_VAL_QUALITY_CDE,
MINIMUM_ACCOUNT_BALANCE_AMT,
TOTAL_PUA_CASH_VAL_AMT,
TOTAL_PUA_CASH_VAL_QUALITY_CDE,
FUND_BALANCE_AMT,
INT_LTC_BENEFIT_AMT,
PAIDUP_AVAILABLE_AMT,
PAIDUP_AVAILABLE_QUALITY_CDE,
PAIDUP_FACE_AMT,
PAIDUP_FACE_QUALITY_CDE,
MGIR_RT,
MGIR_RT_QUALITY_CDE,
TOTAL_FIRST_YEAR_DEPOSIT_AMT,
TOTAL_ROLLOVER_AMT,
TOTAL_WITHDRAWAL_AMT,
PRE_TEFRA_TAMRA_AMT,
POST_TEFRA_TAMRA_AMT,
AVAILABLE_WITHDRAWAL_FIXED_AMT,
AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
NEXT_PAYOUT_DT,
END_PERIOD_CERTAIN_DT,
LAST_PAYOUT_DT,
TOTAL_GROSS_PAYOUT_AMT,
TOTAL_NET_PAYOUT_AMT,
YTD_GROSS_PAYOUT_AMT,
YTD_NET_PAYOUT_AMT,
YTD_WITHDRAWAL_AMT,
BASIC_FREE_WITHDRAWAL_AMT,
ADDITIONAL_FREE_WITHDRAWAL_AMT,
YTD_NET_WITHDRAWAL_AMT,
MVA_AMT,
MINIMUM_SURRENDER_VAL_AMT,
CONTRACT_GUARANTEED_INTEREST_RT,
GMDB_AMT,
GMDB_RATCHET_AMT,
GMDB_ROLLUP_AMT,
GMIB_RATCHET_AMT,
GMIB_ROLLUP_AMT,
GMIB_DT,
NET_RISK_AMT,
PYTD_WITHDRAWAL_AMT,
NET_PURCHASE_PAYMENT_AMT,
COVERED_CONTRACT_VAL_AMT,
CYTD_CHARGE_AMT,
RMD_AMT,
FAIR_MARKET_VAL_AMT,
GMAB_BASE_AMT,
GMAB_NEXT_RESET_DT,
GMAB_LAST_RESET_DT,
TOTAL_COST_BASIS_AMT,
PRE_TEFRA_AMT,
POST_TEFRA_AMT,
TOTAL_AVAILABLE_WITHDRAWAL_AMT,
RMD_QUOTE_AMT,
MGIR_REDETERMINATION_DT,
MVA_ACCOUNT_VAL_AMT,
GLWB_BENEFIT_BASE_AMT,
GLWB_ROLLUP_RT,
GLWB_BENEFIT_PAYMENT_AMT,
GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
GLWB_WITHDRAWAL_RT,
GLWB_LIFETIME_GUARANTEE_RT,
GLWB_WITHDRAWAL_RT_AGE_NR,
GMSV_INTEREST_RT,
GLWB_LAST_STEP_UP_DT,
RMD_REMAINING_AMT,
ACCUMULATED_POLICY_VAL_AMT,
ACCUMULATED_POLICY_VAL_QUALITY_CDE,
NET_ANNUAL_PREMIUM_AMT,
NET_ANNUAL_PREMIUM_QUALITY_CDE,
INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
ADDITIONS_PURCHASE_AMT,
ADDITIONS_PURCHASE_QUALITY_CDE,
SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
BASIC_AMT,
BASIC_QUALITY_CDE,
TOTAL_POLICY_CASH_VAL_AMT,
TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
RP_RN_RI_AMT,
RP_RN_RI_QUALITY_CDE,
RAFP_IRAFP_RESERVE_AMT,
RAFP_IRAFP_RESERVE_QUALITY_CDE,
DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
ONE_YEAR_TERM_COST_AMT,
ONE_YEAR_TERM_COST_QUALITY_CDE,
YEAR_TERM_AGREEMENT_AMT,
YEAR_TERM_AGREEMENT_QUALITY_CDE,
GMIB_ACCOUNT_VAL_AMT,
YEAR_END_VAL_AMT,
ALIR_ANNUAL_PREMIUM_AMT,
ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
ALIR_CATCHUP_AVAILABLE_AMT,
ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
ALIR_CATCHUP_APPLIED_AMT,
ALIR_CATCHUP_APPLIED_QUALITY_CDE,
ALIR_CV_DIVIDEND_ADDITIONS_AMT,
ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
ALIR_CV_PAIDUP_ADDITIONS_AMT,
ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
ALIR_DIVIDEND_AMT,
ALIR_DIVIDEND_QUALITY_CDE,
ALIR_DIVIDEND_ADDITIONS_AMT,
ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
ALIR_DIVIDEND_AVAILABLE_AMT,
ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
ALIR_MODAL_PREMIUM_AMT,
ALIR_MODAL_PREMIUM_QUALITY_CDE,
ALIR_MONTHLY_PREMIUM_AMT,
ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
ALIR_POLICY_YEAR_NR,
ALIR_PAIDUP_ADDITIONS_AMT,
ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
ALIR_UNSCHEDULED_PREMIUM_AMT,
ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
CV_PD_ALIR_LISR_AMT,
CV_PD_ALIR_LISR_QUALITY_CDE,
LISR_CV_DIVIDEND_ADDITIONS_AMT,
LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
LISR_CV_PAIDUP_ADDITIONS_AMT,
LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
LISR_DIVIDEND_AMT,
LISR_DIVIDEND_QUALITY_CDE,
LISR_DIVIDEND_ADDITIONS_AMT,
LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
LISR_DIVIDEND_AVAILABLE_AMT,
LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
LISR_PAIDUP_ADDITIONS_AMT,
LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
LISR_ANNUAL_PREMIUM_AMT,
LISR_ANNUAL_PREMIUM_QUALITY_CDE,
LISR_FACE_AMT,
LISR_FACE_QUALITY_CDE,
LISR_MONTHLY_PREMIUM_AMT,
LISR_MONTHLY_PREMIUM_QUALITY_CDE,
LISR_MODAL_PREMIUM_AMT,
LISR_MODAL_PREMIUM_QUALITY_CDE,
LISR_RECOMMENDED_PREMIUM_AMT,
LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
LISR_UNSCHEDULED_PREMIUM_AMT,
LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
LTC_PREMIUM_ADJUSTMENT_CDE,
LTC_ACTIVE_CDE,
LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
LTC_DIVIDENDS_BENEFIT_POOL_AMT,
LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
LTC_RETURN_PREMIUM_AMT,
LTC_RETURN_PREMIUM_QUALITY_CDE,
LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
LTC_CURRENT_MMB_AMT,
LTC_CURRENT_MMB_QUALITY_CDE,
LTC_BASE_BENEFIT_POOL_AMT,
LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
LTC_INITIAL_MMB_AMT,
LTC_INITIAL_MMB_QUALITY_CDE,
LTC_MMB_INCREASE_OPTION_IND,
LTC_MMB_INCREASE_AMT,
LTC_MMB_INCREASE_QUALITY_CDE,
LTC_NEXT_MMB_INCREASE_DT,
LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
LTC_RESIDUAL_DEATH_BENEFIT_AMT,
LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
LTC_SELECTED_BENEFIT_PERIOD_NR,
LTC_CLAIM_START_DT,
PAIDUP_ADDITIONS_FACE_AMT,
PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
SL100_SL20P_POLICY_IND,
PALIR_MAX_ANNUAL_PAYMENT_AMT,
PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
PALIR_PREMIUM_START_DT,
PALIR_PREMIUM_END_DT,
PALIR_YTD_PREMIUM_PAID_AMT,
PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
PALIR_ANNUAL_PAYMENT_CNT,
BEGIN_DT,
BEGIN_DTM,
ROW_PROCESS_DTM,
CHECK_SUM,
END_DT,
END_DTM,
RESTRICTED_ROW_IND,
CURRENT_ROW_IND,
LOGICAL_DELETE_IND,
SOURCE_SYSTEM_ID,
AUDIT_ID,
UPDATE_AUDIT_ID,
SOURCE_DELETE_IND,
CREDITING_RT,
CREDITING_RT_START_DT,
CREDITING_RT_END_DT,
CREDITING_REST_PERIOD_DESC,
GROSS_NET_CDE,
END_DT_BOOK_VAL_AMT,
END_DT_MARKET_VAL_AMT,
NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
NEXT_BUSINESS_DAY_CREDITING_RT
)
SELECT
STG.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
--STG.VALU_AGREEMENT_NO,
STG.AGREEMENT_VAL_AS_OF_DT,
STG.TOTAL_CONTRIBUTION_AMT,
STG.TOTAL_CONTRIBUTION_QUALITY_CDE,
STG.NET_DEATH_BENEFIT_AMT,
STG.NET_DEATH_BENEFIT_QUALITY_CDE,
STG.NET_DEATH_BENEFIT_DT,
STG.NET_CASH_VAL_AMT,
STG.NET_CASH_VAL_QUALITY_CDE,
STG.TOTAL_ACCOUNT_VAL_AMT,
STG.TOTAL_ACCOUNT_VAL_QUALITY_CDE,
STG.GROSS_CASH_VAL_AMT,
STG.GROSS_CASH_VAL_QUALITY_CDE,
STG.SURRENDER_CHARGE_AMT,
STG.SURRENDER_CHARGE_QUALITY_CDE,
STG.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
STG.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
STG.DEFICIENCY_AMT,
STG.DEFICIENCY_QUALITY_CDE,
STG.LOW_DEATH_BENEFIT_AMT,
STG.LOW_DEATH_BENEFIT_QUALITY_CDE,
STG.EXCHANGE_1035_AMT,
STG.EXCHANGE_1035_QUALITY_CDE,
STG.EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
STG.SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
STG.TERM_RIDER_COVERAGE_AMT,
STG.TERM_RIDER_COVERAGE_QUALITY_CDE,
STG.DAY_OLD_IND,
STG.SOURCE_DAY_OLD_IND,
STG.ARREARS_INTEREST_CREDIT_AMT,
STG.ARREARS_INTEREST_PAID_AMT,
STG.MINIMUM_CASH_REQUIRED_AMT,
STG.MINIMUM_CASH_REQUIRED_QUALITY_CDE,
STG.NET_DUE_AMT,
STG.NET_DUE_QUALITY_CDE,
STG.GROSS_DEATH_BENEFIT_AMT,
STG.GROSS_DEATH_BENEFIT_QUALITY_CDE,
STG.CONTRACT_VAL_AMT,
STG.CONTRACT_VAL_QUALITY_CDE,
STG.MINIMUM_ACCOUNT_BALANCE_AMT,
STG.TOTAL_PUA_CASH_VAL_AMT,
STG.TOTAL_PUA_CASH_VAL_QUALITY_CDE,
STG.FUND_BALANCE_AMT,
STG.INT_LTC_BENEFIT_AMT,
STG.PAIDUP_AVAILABLE_AMT,
STG.PAIDUP_AVAILABLE_QUALITY_CDE,
STG.PAIDUP_FACE_AMT,
STG.PAIDUP_FACE_QUALITY_CDE,
STG.MGIR_RT,
STG.MGIR_RT_QUALITY_CDE,
STG.TOTAL_FIRST_YEAR_DEPOSIT_AMT,
STG.TOTAL_ROLLOVER_AMT,
STG.TOTAL_WITHDRAWAL_AMT,
STG.PRE_TEFRA_TAMRA_AMT,
STG.POST_TEFRA_TAMRA_AMT,
STG.AVAILABLE_WITHDRAWAL_FIXED_AMT,
STG.AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
STG.NEXT_PAYOUT_DT,
STG.END_PERIOD_CERTAIN_DT,
STG.LAST_PAYOUT_DT,
STG.TOTAL_GROSS_PAYOUT_AMT,
STG.TOTAL_NET_PAYOUT_AMT,
STG.YTD_GROSS_PAYOUT_AMT,
STG.YTD_NET_PAYOUT_AMT,
STG.YTD_WITHDRAWAL_AMT,
STG.BASIC_FREE_WITHDRAWAL_AMT,
STG.ADDITIONAL_FREE_WITHDRAWAL_AMT,
STG.YTD_NET_WITHDRAWAL_AMT,
STG.MVA_AMT,
STG.MINIMUM_SURRENDER_VAL_AMT,
STG.CONTRACT_GUARANTEED_INTEREST_RT,
STG.GMDB_AMT,
STG.GMDB_RATCHET_AMT,
STG.GMDB_ROLLUP_AMT,
STG.GMIB_RATCHET_AMT,
STG.GMIB_ROLLUP_AMT,
STG.GMIB_DT,
STG.NET_RISK_AMT,
STG.PYTD_WITHDRAWAL_AMT,
STG.NET_PURCHASE_PAYMENT_AMT,
STG.COVERED_CONTRACT_VAL_AMT,
STG.CYTD_CHARGE_AMT,
STG.RMD_AMT,
STG.FAIR_MARKET_VAL_AMT,
STG.GMAB_BASE_AMT,
STG.GMAB_NEXT_RESET_DT,
STG.GMAB_LAST_RESET_DT,
STG.TOTAL_COST_BASIS_AMT,
STG.PRE_TEFRA_AMT,
STG.POST_TEFRA_AMT,
STG.TOTAL_AVAILABLE_WITHDRAWAL_AMT,
STG.RMD_QUOTE_AMT,
STG.MGIR_REDETERMINATION_DT,
STG.MVA_ACCOUNT_VAL_AMT,
STG.GLWB_BENEFIT_BASE_AMT,
STG.GLWB_ROLLUP_RT,
STG.GLWB_BENEFIT_PAYMENT_AMT,
STG.GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
STG.GLWB_WITHDRAWAL_RT,
STG.GLWB_LIFETIME_GUARANTEE_RT,
STG.GLWB_WITHDRAWAL_RT_AGE_NR,
STG.GMSV_INTEREST_RT,
STG.GLWB_LAST_STEP_UP_DT,
STG.RMD_REMAINING_AMT,
STG.ACCUMULATED_POLICY_VAL_AMT,
STG.ACCUMULATED_POLICY_VAL_QUALITY_CDE,
STG.NET_ANNUAL_PREMIUM_AMT,
STG.NET_ANNUAL_PREMIUM_QUALITY_CDE,
STG.INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
STG.INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
STG.ADDITIONS_PURCHASE_AMT,
STG.ADDITIONS_PURCHASE_QUALITY_CDE,
STG.SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
STG.SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
STG.BASIC_AMT,
STG.BASIC_QUALITY_CDE,
STG.TOTAL_POLICY_CASH_VAL_AMT,
STG.TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
STG.RP_RN_RI_AMT,
STG.RP_RN_RI_QUALITY_CDE,
STG.RAFP_IRAFP_RESERVE_AMT,
STG.RAFP_IRAFP_RESERVE_QUALITY_CDE,
STG.DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
STG.DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
STG.DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
STG.DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
STG.ONE_YEAR_TERM_COST_AMT,
STG.ONE_YEAR_TERM_COST_QUALITY_CDE,
STG.YEAR_TERM_AGREEMENT_AMT,
STG.YEAR_TERM_AGREEMENT_QUALITY_CDE,
STG.GMIB_ACCOUNT_VAL_AMT,
STG.YEAR_END_VAL_AMT,
STG.ALIR_ANNUAL_PREMIUM_AMT,
STG.ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
STG.ALIR_CATCHUP_AVAILABLE_AMT,
STG.ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
STG.ALIR_CATCHUP_APPLIED_AMT,
STG.ALIR_CATCHUP_APPLIED_QUALITY_CDE,
STG.ALIR_CV_DIVIDEND_ADDITIONS_AMT,
STG.ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
STG.ALIR_CV_PAIDUP_ADDITIONS_AMT,
STG.ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.ALIR_DIVIDEND_AMT,
STG.ALIR_DIVIDEND_QUALITY_CDE,
STG.ALIR_DIVIDEND_ADDITIONS_AMT,
STG.ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
STG.ALIR_DIVIDEND_AVAILABLE_AMT,
STG.ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
STG.ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
STG.ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
STG.ALIR_MODAL_PREMIUM_AMT,
STG.ALIR_MODAL_PREMIUM_QUALITY_CDE,
STG.ALIR_MONTHLY_PREMIUM_AMT,
STG.ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
STG.ALIR_POLICY_YEAR_NR,
STG.ALIR_PAIDUP_ADDITIONS_AMT,
STG.ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
STG.ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
STG.ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
STG.ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
STG.ALIR_UNSCHEDULED_PREMIUM_AMT,
STG.ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
STG.ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
STG.ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
STG.ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
STG.ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
STG.LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
STG.LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
STG.LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
STG.LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
STG.CV_PD_ALIR_LISR_AMT,
STG.CV_PD_ALIR_LISR_QUALITY_CDE,
STG.LISR_CV_DIVIDEND_ADDITIONS_AMT,
STG.LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
STG.LISR_CV_PAIDUP_ADDITIONS_AMT,
STG.LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.LISR_DIVIDEND_AMT,
STG.LISR_DIVIDEND_QUALITY_CDE,
STG.LISR_DIVIDEND_ADDITIONS_AMT,
STG.LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
STG.LISR_DIVIDEND_AVAILABLE_AMT,
STG.LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
STG.LISR_PAIDUP_ADDITIONS_AMT,
STG.LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.LISR_ANNUAL_PREMIUM_AMT,
STG.LISR_ANNUAL_PREMIUM_QUALITY_CDE,
STG.LISR_FACE_AMT,
STG.LISR_FACE_QUALITY_CDE,
STG.LISR_MONTHLY_PREMIUM_AMT,
STG.LISR_MONTHLY_PREMIUM_QUALITY_CDE,
STG.LISR_MODAL_PREMIUM_AMT,
STG.LISR_MODAL_PREMIUM_QUALITY_CDE,
STG.LISR_RECOMMENDED_PREMIUM_AMT,
STG.LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
STG.LISR_UNSCHEDULED_PREMIUM_AMT,
STG.LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
STG.LTC_PREMIUM_ADJUSTMENT_CDE,
STG.LTC_ACTIVE_CDE,
STG.LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
STG.LTC_DIVIDENDS_BENEFIT_POOL_AMT,
STG.LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
STG.LTC_RETURN_PREMIUM_AMT,
STG.LTC_RETURN_PREMIUM_QUALITY_CDE,
STG.LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
STG.LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
STG.LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
STG.LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
STG.LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
STG.LTC_CURRENT_MMB_AMT,
STG.LTC_CURRENT_MMB_QUALITY_CDE,
STG.LTC_BASE_BENEFIT_POOL_AMT,
STG.LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
STG.LTC_INITIAL_MMB_AMT,
STG.LTC_INITIAL_MMB_QUALITY_CDE,
STG.LTC_MMB_INCREASE_OPTION_IND,
STG.LTC_MMB_INCREASE_AMT,
STG.LTC_MMB_INCREASE_QUALITY_CDE,
STG.LTC_NEXT_MMB_INCREASE_DT,
STG.LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
STG.LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
STG.LTC_RESIDUAL_DEATH_BENEFIT_AMT,
STG.LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
STG.LTC_SELECTED_BENEFIT_PERIOD_NR,
STG.LTC_CLAIM_START_DT,
STG.PAIDUP_ADDITIONS_FACE_AMT,
STG.PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
STG.SL100_SL20P_POLICY_IND,
STG.PALIR_MAX_ANNUAL_PAYMENT_AMT,
STG.PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
STG.PALIR_PREMIUM_START_DT,
STG.PALIR_PREMIUM_END_DT,
STG.PALIR_YTD_PREMIUM_PAID_AMT,
STG.PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
STG.PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
STG.PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
STG.PALIR_ANNUAL_PAYMENT_CNT,
STG.BEGIN_DT,
STG.BEGIN_DTM,
STG.ROW_PROCESS_DTM,
--STG.CHECK_SUM,
UUID_GEN
(
STG.AGREEMENT_VAL_AS_OF_DT,
STG.TOTAL_CONTRIBUTION_AMT,
STG.NET_CASH_VAL_AMT,
STG.GROSS_CASH_VAL_AMT,
STG.SURRENDER_CHARGE_AMT,
STG.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
STG.MGIR_RT,
STG.TOTAL_FIRST_YEAR_DEPOSIT_AMT,
STG.TOTAL_ROLLOVER_AMT,
STG.PRE_TEFRA_TAMRA_AMT,
STG.POST_TEFRA_TAMRA_AMT,
STG.TOTAL_GROSS_PAYOUT_AMT,
STG.TOTAL_NET_PAYOUT_AMT,
STG.YTD_GROSS_PAYOUT_AMT,
STG.YTD_NET_PAYOUT_AMT,
STG.YTD_WITHDRAWAL_AMT,
STG.BASIC_FREE_WITHDRAWAL_AMT,
STG.MVA_AMT,
STG.MINIMUM_SURRENDER_VAL_AMT,
STG.TOTAL_AVAILABLE_WITHDRAWAL_AMT,
STG.SOURCE_DELETE_IND
)::UUID AS CHECK_SUM,
STG.END_DT,
STG.END_DTM,
STG.RESTRICTED_ROW_IND,
STG.CURRENT_ROW_IND,
STG.LOGICAL_DELETE_IND,
STG.SOURCE_SYSTEM_ID,
STG.AUDIT_ID,
STG.UPDATE_AUDIT_ID,
STG.SOURCE_DELETE_IND,
STG.CREDITING_RT,
STG.CREDITING_RT_START_DT,
STG.CREDITING_RT_END_DT,
STG.CREDITING_REST_PERIOD_DESC,
STG.GROSS_NET_CDE,
STG.END_DT_BOOK_VAL_AMT,
STG.END_DT_MARKET_VAL_AMT,
STG.NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
STG.NEXT_BUSINESS_DAY_CREDITING_RT
FROM
(
SELECT
UUID_GEN(
        CLEAN_STRING(AGREEMENT_SDT.TRNSLT_FLD_VAL),
        CLEAN_STRING('IPA'),
        CLEAN_STRING(PUBLIC.UDF_AIF_HLDG_KEY_FORMAT(CONTRACT.AIFCOW_POLICY_ID,'PFX')), 
        CLEAN_STRING(PUBLIC.UDF_AIF_HLDG_KEY_FORMAT(CONTRACT.AIFCOW_POLICY_ID,'KEY')), 
        CLEAN_STRING(PUBLIC.UDF_AIF_HLDG_KEY_FORMAT(CONTRACT.AIFCOW_POLICY_ID,'SFX'))
        )::UUID AS DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
CASE WHEN 
TO_CHAR(CONTRACT.AIFCOW_VALUATION_YYYY)||LPAD(TO_CHAR(CONTRACT.AIFCOW_VALUATION_MM),2,'0')||LPAD(TO_CHAR(CONTRACT.AIFCOW_VALUATION_DD),2,'0')=99999999
OR TO_CHAR(CONTRACT.AIFCOW_VALUATION_YYYY)||LPAD(TO_CHAR(CONTRACT.AIFCOW_VALUATION_MM),2,'0')||LPAD(TO_CHAR(CONTRACT.AIFCOW_VALUATION_DD),2,'0')>52000000
THEN TO_DATE('9999-12-31','YYYY-MM-DD')
ELSE
public.isdate((TO_CHAR(CONTRACT.AIFCOW_VALUATION_YYYY))||LPAD(TO_CHAR(CONTRACT.AIFCOW_VALUATION_MM),2,'0')||LPAD(TO_CHAR(CONTRACT.AIFCOW_VALUATION_DD),2,'0'))
END AS AGREEMENT_VAL_AS_OF_DT,
CONTRACT.AIFCOW_TOTAL_PREMIUM_VALUE	AS TOTAL_CONTRIBUTION_AMT,
NULL AS  TOTAL_CONTRIBUTION_QUALITY_CDE,
NULL AS  NET_DEATH_BENEFIT_AMT,
NULL AS  NET_DEATH_BENEFIT_QUALITY_CDE,
NULL AS  NET_DEATH_BENEFIT_DT,
CONTRACT.AIFCOW_SURRENDER_VALUE	AS NET_CASH_VAL_AMT,
NULL AS NET_CASH_VAL_QUALITY_CDE,
NULL AS TOTAL_ACCOUNT_VAL_AMT,
NULL AS TOTAL_ACCOUNT_VAL_QUALITY_CDE,
CONTRACT.AIFCOW_ACCUM_CASH_VALUE AS GROSS_CASH_VAL_AMT,
NULL AS GROSS_CASH_VAL_QUALITY_CDE,
CONTRACT.AIFCOW_SURRENDER_CHRG_AMT AS SURRENDER_CHARGE_AMT,
NULL AS SURRENDER_CHARGE_QUALITY_CDE,
CONTRACT.AIFCOW_DEATH_BENEFIT_VALUE    AS GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
NULL AS GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
NULL AS DEFICIENCY_AMT,
NULL AS DEFICIENCY_QUALITY_CDE,
NULL AS LOW_DEATH_BENEFIT_AMT,
NULL AS LOW_DEATH_BENEFIT_QUALITY_CDE,
NULL AS EXCHANGE_1035_AMT,
NULL AS EXCHANGE_1035_QUALITY_CDE,
NULL AS EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
NULL AS SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
NULL AS TERM_RIDER_COVERAGE_AMT,
NULL AS TERM_RIDER_COVERAGE_QUALITY_CDE,
CLEAN_STRING(NULL)::BOOLEAN AS DAY_OLD_IND,
NULL AS SOURCE_DAY_OLD_IND,
NULL AS ARREARS_INTEREST_CREDIT_AMT,
NULL AS ARREARS_INTEREST_PAID_AMT,
NULL AS MINIMUM_CASH_REQUIRED_AMT,
NULL AS MINIMUM_CASH_REQUIRED_QUALITY_CDE,
NULL AS NET_DUE_AMT,
NULL AS NET_DUE_QUALITY_CDE,
NULL AS GROSS_DEATH_BENEFIT_AMT,
NULL AS GROSS_DEATH_BENEFIT_QUALITY_CDE,
NULL AS CONTRACT_VAL_AMT,
NULL AS CONTRACT_VAL_QUALITY_CDE,
NULL AS MINIMUM_ACCOUNT_BALANCE_AMT,
NULL AS TOTAL_PUA_CASH_VAL_AMT,
NULL AS TOTAL_PUA_CASH_VAL_QUALITY_CDE,
NULL AS FUND_BALANCE_AMT,
NULL AS INT_LTC_BENEFIT_AMT,
NULL AS PAIDUP_AVAILABLE_AMT, 
NULL AS PAIDUP_AVAILABLE_QUALITY_CDE,
NULL AS PAIDUP_FACE_AMT,
NULL AS PAIDUP_FACE_QUALITY_CDE,
CONTRACT.AIFCOW_MIN_GTEED_INT_PCT AS MGIR_RT,
NULL AS MGIR_RT_QUALITY_CDE,
CONTRACT.AIFCOW_TOT_1ST_YR_DEP_AMT AS TOTAL_FIRST_YEAR_DEPOSIT_AMT,
CONTRACT.AIFCOW_TOTAL_ROLLOVER AS TOTAL_ROLLOVER_AMT,
NULL AS TOTAL_WITHDRAWAL_AMT,
CONTRACT.AIFCOW_PRE_TEF_TAM_CST_AMT AS PRE_TEFRA_TAMRA_AMT,
CONTRACT.AIFCOW_POST_TEF_TAM_CST_AMT AS POST_TEFRA_TAMRA_AMT,
NULL AS AVAILABLE_WITHDRAWAL_FIXED_AMT,
NULL AS AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
NULL AS NEXT_PAYOUT_DT,
NULL AS END_PERIOD_CERTAIN_DT,
NULL AS LAST_PAYOUT_DT,
CONTRACT.AIFCOW_TOT_GROSS_PYOT_AMT AS TOTAL_GROSS_PAYOUT_AMT,
CONTRACT.AIFCOW_TOT_NET_PYOT_AMT AS TOTAL_NET_PAYOUT_AMT,
CONTRACT.AIFCOW_YTD_GRS_PYOT_AMT AS YTD_GROSS_PAYOUT_AMT,
CONTRACT.AIFCOW_YTD_NET_PYOT_AMT AS YTD_NET_PAYOUT_AMT,
CONTRACT.AIFCOW_YTD_WDRWL_AMT AS YTD_WITHDRAWAL_AMT,
CONTRACT.AIFCOW_FREE_WITHDRL_AMT AS BASIC_FREE_WITHDRAWAL_AMT,
NULL AS ADDITIONAL_FREE_WITHDRAWAL_AMT,
NULL AS YTD_NET_WITHDRAWAL_AMT,
CONTRACT.AIFCOW_MARKET_VALUE_ADJ_AMT AS MVA_AMT,
CONTRACT.AIFCOW_GUAR_MIN_SURRENDER_VAL AS MINIMUM_SURRENDER_VAL_AMT,
NULL AS CONTRACT_GUARANTEED_INTEREST_RT,
NULL AS GMDB_AMT,
NULL AS GMDB_RATCHET_AMT,
NULL AS GMDB_ROLLUP_AMT,
NULL AS GMIB_RATCHET_AMT,
NULL AS GMIB_ROLLUP_AMT,
NULL AS GMIB_DT,
NULL AS NET_RISK_AMT,
NULL AS PYTD_WITHDRAWAL_AMT,
NULL AS NET_PURCHASE_PAYMENT_AMT,
NULL AS COVERED_CONTRACT_VAL_AMT,
NULL AS CYTD_CHARGE_AMT,
NULL AS RMD_AMT,
NULL AS FAIR_MARKET_VAL_AMT,
NULL AS GMAB_BASE_AMT,
NULL AS GMAB_NEXT_RESET_DT,
NULL AS GMAB_LAST_RESET_DT,
NULL AS TOTAL_COST_BASIS_AMT,
NULL AS PRE_TEFRA_AMT,
NULL AS POST_TEFRA_AMT,
CONTRACT.AIFCOW_TOTAL_WITHDRL_VALUE AS TOTAL_AVAILABLE_WITHDRAWAL_AMT,
NULL AS RMD_QUOTE_AMT,
NULL AS MGIR_REDETERMINATION_DT,
NULL AS MVA_ACCOUNT_VAL_AMT,
NULL AS GLWB_BENEFIT_BASE_AMT,
NULL AS GLWB_ROLLUP_RT,
NULL AS GLWB_BENEFIT_PAYMENT_AMT,
NULL AS GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
NULL AS GLWB_WITHDRAWAL_RT,
NULL AS GLWB_LIFETIME_GUARANTEE_RT,
NULL AS GLWB_WITHDRAWAL_RT_AGE_NR,
NULL AS GMSV_INTEREST_RT,
NULL AS GLWB_LAST_STEP_UP_DT,
NULL AS RMD_REMAINING_AMT,
NULL AS ACCUMULATED_POLICY_VAL_AMT,
NULL AS ACCUMULATED_POLICY_VAL_QUALITY_CDE,
NULL AS NET_ANNUAL_PREMIUM_AMT,
NULL AS NET_ANNUAL_PREMIUM_QUALITY_CDE,
NULL AS INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
NULL AS INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
NULL AS ADDITIONS_PURCHASE_AMT,
NULL AS ADDITIONS_PURCHASE_QUALITY_CDE,
NULL AS SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
NULL AS SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
NULL								    AS BASIC_AMT,
NULL                                    AS BASIC_QUALITY_CDE,
NULL								    AS TOTAL_POLICY_CASH_VAL_AMT,
NULL                                    AS TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
NULL								    AS RP_RN_RI_AMT,
NULL                                    AS RP_RN_RI_QUALITY_CDE,
NULL 								    AS RAFP_IRAFP_RESERVE_AMT,
NULL                                    AS RAFP_IRAFP_RESERVE_QUALITY_CDE,
NULL								    AS DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
NULL                                    AS DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
NULL 								    AS DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
NULL                                    AS DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
NULL 								    AS ONE_YEAR_TERM_COST_AMT,
NULL                                    AS ONE_YEAR_TERM_COST_QUALITY_CDE,
NULL 								    AS YEAR_TERM_AGREEMENT_AMT,
NULL                                    AS YEAR_TERM_AGREEMENT_QUALITY_CDE,
NULL                                    AS GMIB_ACCOUNT_VAL_AMT,
NULL                                    AS YEAR_END_VAL_AMT,
NULL                                    AS ALIR_ANNUAL_PREMIUM_AMT,
NULL                                    AS ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
NULL                                    AS ALIR_CATCHUP_AVAILABLE_AMT,
NULL                                    AS ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
NULL                                    AS ALIR_CATCHUP_APPLIED_AMT,
NULL                                    AS ALIR_CATCHUP_APPLIED_QUALITY_CDE,
NULL AS ALIR_CV_DIVIDEND_ADDITIONS_AMT,
NULL AS ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
NULL AS ALIR_CV_PAIDUP_ADDITIONS_AMT,
NULL AS ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL AS ALIR_DIVIDEND_AMT,
NULL AS	ALIR_DIVIDEND_QUALITY_CDE,
NULL AS	ALIR_DIVIDEND_ADDITIONS_AMT,
NULL AS	ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
NULL AS ALIR_DIVIDEND_AVAILABLE_AMT,
NULL AS ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
NULL                AS ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
NULL                AS ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
NULL				AS ALIR_MODAL_PREMIUM_AMT,
NULL   			    AS ALIR_MODAL_PREMIUM_QUALITY_CDE,
NULL                AS ALIR_MONTHLY_PREMIUM_AMT,
NULL                AS ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
NULL                AS ALIR_POLICY_YEAR_NR,
NULL AS ALIR_PAIDUP_ADDITIONS_AMT,
NULL AS ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL                AS ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
NULL                AS ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
NULL                AS ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
NULL                AS ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
NULL                AS ALIR_UNSCHEDULED_PREMIUM_AMT,
NULL                AS ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
NULL                AS ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
NULL                AS ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
NULL                AS ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
NULL                AS ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
NULL                AS LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
NULL                AS LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
NULL                AS LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
NULL                AS LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
NULL				AS CV_PD_ALIR_LISR_AMT,
NULL 			    AS CV_PD_ALIR_LISR_QUALITY_CDE,
NULL AS    LISR_CV_DIVIDEND_ADDITIONS_AMT,
NULL AS    LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
NULL AS    LISR_CV_PAIDUP_ADDITIONS_AMT,
NULL AS    LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL AS    LISR_DIVIDEND_AMT,
NULL AS    LISR_DIVIDEND_QUALITY_CDE,
NULL AS    LISR_DIVIDEND_ADDITIONS_AMT,
NULL AS    LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
NULL AS    LISR_DIVIDEND_AVAILABLE_AMT,
NULL AS    LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
NULL AS	LISR_PAIDUP_ADDITIONS_AMT,
NULL AS	LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL AS LISR_ANNUAL_PREMIUM_AMT,
NULL AS LISR_ANNUAL_PREMIUM_QUALITY_CDE,
NULL AS LISR_FACE_AMT,
NULL AS LISR_FACE_QUALITY_CDE,
NULL AS LISR_MONTHLY_PREMIUM_AMT,
NULL AS LISR_MONTHLY_PREMIUM_QUALITY_CDE,
NULL AS LISR_MODAL_PREMIUM_AMT,
NULL AS LISR_MODAL_PREMIUM_QUALITY_CDE,
NULL AS LISR_RECOMMENDED_PREMIUM_AMT,
NULL AS LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
NULL AS LISR_UNSCHEDULED_PREMIUM_AMT,
NULL AS LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
NULL AS LTC_PREMIUM_ADJUSTMENT_CDE,
NULL AS LTC_ACTIVE_CDE,
NULL AS LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
NULL AS LTC_DIVIDENDS_BENEFIT_POOL_AMT,
NULL AS LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
NULL AS LTC_RETURN_PREMIUM_AMT,
NULL AS LTC_RETURN_PREMIUM_QUALITY_CDE,
NULL AS LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
NULL AS LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL AS LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
NULL AS LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
NULL AS LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
NULL AS LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
NULL AS LTC_CURRENT_MMB_AMT,
NULL AS LTC_CURRENT_MMB_QUALITY_CDE,
NULL AS LTC_BASE_BENEFIT_POOL_AMT,
NULL AS LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
NULL AS LTC_INITIAL_MMB_AMT,
NULL AS LTC_INITIAL_MMB_QUALITY_CDE,
CLEAN_STRING(NULL)::BOOLEAN AS LTC_MMB_INCREASE_OPTION_IND,
NULL AS LTC_MMB_INCREASE_AMT,
NULL AS LTC_MMB_INCREASE_QUALITY_CDE,
NULL AS LTC_NEXT_MMB_INCREASE_DT,
NULL AS LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
NULL AS LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
NULL AS LTC_RESIDUAL_DEATH_BENEFIT_AMT,
NULL AS LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
NULL AS  LTC_SELECTED_BENEFIT_PERIOD_NR,
NULL AS LTC_CLAIM_START_DT,
NULL AS PAIDUP_ADDITIONS_FACE_AMT,
NULL AS PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
CLEAN_STRING(NULL)::BOOLEAN AS SL100_SL20P_POLICY_IND,
NULL AS PALIR_MAX_ANNUAL_PAYMENT_AMT,
NULL AS PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
NULL AS PALIR_PREMIUM_START_DT,
NULL AS PALIR_PREMIUM_END_DT,
NULL AS PALIR_YTD_PREMIUM_PAID_AMT,
NULL AS PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
NULL AS PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
NULL AS PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
NULL AS PALIR_ANNUAL_PAYMENT_CNT,
TO_DATE(TO_CHAR(CTRTCNT.CYCLE_DATE),'YYYYMMDD')		AS BEGIN_DT,
TO_DATE(TO_CHAR(CTRTCNT.CYCLE_DATE),'YYYYMMDD')::TIMESTAMP AS BEGIN_DTM,
CURRENT_TIMESTAMP(6) 									            AS ROW_PROCESS_DTM,
'9999-12-31'::DATE                                     	            AS END_DT,
'9999-12-31'::TIMESTAMP                                             AS END_DTM,
FALSE 													AS RESTRICTED_ROW_IND,
TRUE 													AS CURRENT_ROW_IND,
FALSE  													AS LOGICAL_DELETE_IND,
72 														AS SOURCE_SYSTEM_ID,
:audit_id   											AS AUDIT_ID,
:audit_id 												AS UPDATE_AUDIT_ID,
CASE
         WHEN CONTRACT.PROCESSED_IND ='D' THEN TRUE
         ELSE FALSE
    END AS SOURCE_DELETE_IND,
NULL AS CREDITING_RT,
NULL AS CREDITING_RT_START_DT,
NULL AS CREDITING_RT_END_DT,
NULL AS CREDITING_REST_PERIOD_DESC,
NULL AS GROSS_NET_CDE,
NULL AS END_DT_BOOK_VAL_AMT,
NULL AS END_DT_MARKET_VAL_AMT,
NULL AS NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
NULL AS NEXT_BUSINESS_DAY_CREDITING_RT
FROM 
(SELECT * FROM EDW_STAGING.AIF_RPS_EDW_CTRT_FULL_DEDUP
 UNION
SELECT * FROM EDW_STAGING.AIF_RPS_EDW_CTRT_DELTA_DEDUP
WHERE PROCESSED_IND='D' 
)CONTRACT

    INNER JOIN EDW_STAGING.AIF_RPS_EDW_CTRT_FULL_COUNT CTRTCNT
        ON CTRTCNT.AUDIT_ID                         =CONTRACT.AUDIT_ID
        AND CTRTCNT.SOURCE_SYSTEM_ID=72

    LEFT JOIN (SELECT DISTINCT TRNSLT_FLD_VAL, SRC_CDE, SRC_FLD_NM, SRC_FLD_VAL, SRC_TBL_NM , TRNSLT_FLD_NM FROM EDW_REF.SRC_DATA_TRNSLT) AGREEMENT_SDT
    ON UPPER(BTRIM(AGREEMENT_SDT.SRC_CDE))         ='ANN'
    AND UPPER(BTRIM(AGREEMENT_SDT.SRC_FLD_NM))     ='ADMN_SYS_CDE'
    AND UPPER(BTRIM(AGREEMENT_SDT.TRNSLT_FLD_NM))  = 'ADMIN OR SOURCE SYSTEM CODE'
    AND UPPER(BTRIM(AGREEMENT_SDT.SRC_FLD_VAL))    = UPPER(udf_replaceemptystr(CONTRACT.AIFCOW_SOURCE_SYSTEM_ID, 'SPACE'))
) STG;

select analyze_statistics('edw_staging.aifrps_attr_agreement_values_pre_work');

-- Step 2: THIS SCRIPT IS USED TO LOAD THE RECORDS THAT DON'T HAVE A RECORD IN TARGET

INSERT INTO edw_work.aifrps_attr_agreement_values
(
DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
AGREEMENT_VAL_AS_OF_DT,
TOTAL_CONTRIBUTION_AMT,
TOTAL_CONTRIBUTION_QUALITY_CDE,
NET_DEATH_BENEFIT_AMT,
NET_DEATH_BENEFIT_QUALITY_CDE,
NET_DEATH_BENEFIT_DT,
NET_CASH_VAL_AMT,
NET_CASH_VAL_QUALITY_CDE,
TOTAL_ACCOUNT_VAL_AMT,
TOTAL_ACCOUNT_VAL_QUALITY_CDE,
GROSS_CASH_VAL_AMT,
GROSS_CASH_VAL_QUALITY_CDE,
SURRENDER_CHARGE_AMT,
SURRENDER_CHARGE_QUALITY_CDE,
GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
DEFICIENCY_AMT,
DEFICIENCY_QUALITY_CDE,
LOW_DEATH_BENEFIT_AMT,
LOW_DEATH_BENEFIT_QUALITY_CDE,
EXCHANGE_1035_AMT,
EXCHANGE_1035_QUALITY_CDE,
EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
TERM_RIDER_COVERAGE_AMT,
TERM_RIDER_COVERAGE_QUALITY_CDE,
DAY_OLD_IND,
SOURCE_DAY_OLD_IND,
ARREARS_INTEREST_CREDIT_AMT,
ARREARS_INTEREST_PAID_AMT,
MINIMUM_CASH_REQUIRED_AMT,
MINIMUM_CASH_REQUIRED_QUALITY_CDE,
NET_DUE_AMT,
NET_DUE_QUALITY_CDE,
GROSS_DEATH_BENEFIT_AMT,
GROSS_DEATH_BENEFIT_QUALITY_CDE,
CONTRACT_VAL_AMT,
CONTRACT_VAL_QUALITY_CDE,
MINIMUM_ACCOUNT_BALANCE_AMT,
TOTAL_PUA_CASH_VAL_AMT,
TOTAL_PUA_CASH_VAL_QUALITY_CDE,
FUND_BALANCE_AMT,
INT_LTC_BENEFIT_AMT,
PAIDUP_AVAILABLE_AMT,
PAIDUP_AVAILABLE_QUALITY_CDE,
PAIDUP_FACE_AMT,
PAIDUP_FACE_QUALITY_CDE,
MGIR_RT,
MGIR_RT_QUALITY_CDE,
TOTAL_FIRST_YEAR_DEPOSIT_AMT,
TOTAL_ROLLOVER_AMT,
TOTAL_WITHDRAWAL_AMT,
PRE_TEFRA_TAMRA_AMT,
POST_TEFRA_TAMRA_AMT,
AVAILABLE_WITHDRAWAL_FIXED_AMT,
AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
NEXT_PAYOUT_DT,
END_PERIOD_CERTAIN_DT,
LAST_PAYOUT_DT,
TOTAL_GROSS_PAYOUT_AMT,
TOTAL_NET_PAYOUT_AMT,
YTD_GROSS_PAYOUT_AMT,
YTD_NET_PAYOUT_AMT,
YTD_WITHDRAWAL_AMT,
BASIC_FREE_WITHDRAWAL_AMT,
ADDITIONAL_FREE_WITHDRAWAL_AMT,
YTD_NET_WITHDRAWAL_AMT,
MVA_AMT,
MINIMUM_SURRENDER_VAL_AMT,
CONTRACT_GUARANTEED_INTEREST_RT,
GMDB_AMT,
GMDB_RATCHET_AMT,
GMDB_ROLLUP_AMT,
GMIB_RATCHET_AMT,
GMIB_ROLLUP_AMT,
GMIB_DT,
NET_RISK_AMT,
PYTD_WITHDRAWAL_AMT,
NET_PURCHASE_PAYMENT_AMT,
COVERED_CONTRACT_VAL_AMT,
CYTD_CHARGE_AMT,
RMD_AMT,
FAIR_MARKET_VAL_AMT,
GMAB_BASE_AMT,
GMAB_NEXT_RESET_DT,
GMAB_LAST_RESET_DT,
TOTAL_COST_BASIS_AMT,
PRE_TEFRA_AMT,
POST_TEFRA_AMT,
TOTAL_AVAILABLE_WITHDRAWAL_AMT,
RMD_QUOTE_AMT,
MGIR_REDETERMINATION_DT,
MVA_ACCOUNT_VAL_AMT,
GLWB_BENEFIT_BASE_AMT,
GLWB_ROLLUP_RT,
GLWB_BENEFIT_PAYMENT_AMT,
GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
GLWB_WITHDRAWAL_RT,
GLWB_LIFETIME_GUARANTEE_RT,
GLWB_WITHDRAWAL_RT_AGE_NR,
GMSV_INTEREST_RT,
GLWB_LAST_STEP_UP_DT,
RMD_REMAINING_AMT,
ACCUMULATED_POLICY_VAL_AMT,
ACCUMULATED_POLICY_VAL_QUALITY_CDE,
NET_ANNUAL_PREMIUM_AMT,
NET_ANNUAL_PREMIUM_QUALITY_CDE,
INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
ADDITIONS_PURCHASE_AMT,
ADDITIONS_PURCHASE_QUALITY_CDE,
SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
BASIC_AMT,
BASIC_QUALITY_CDE,
TOTAL_POLICY_CASH_VAL_AMT,
TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
RP_RN_RI_AMT,
RP_RN_RI_QUALITY_CDE,
RAFP_IRAFP_RESERVE_AMT,
RAFP_IRAFP_RESERVE_QUALITY_CDE,
DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
ONE_YEAR_TERM_COST_AMT,
ONE_YEAR_TERM_COST_QUALITY_CDE,
YEAR_TERM_AGREEMENT_AMT,
YEAR_TERM_AGREEMENT_QUALITY_CDE,
GMIB_ACCOUNT_VAL_AMT,
YEAR_END_VAL_AMT,
ALIR_ANNUAL_PREMIUM_AMT,
ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
ALIR_CATCHUP_AVAILABLE_AMT,
ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
ALIR_CATCHUP_APPLIED_AMT,
ALIR_CATCHUP_APPLIED_QUALITY_CDE,
ALIR_CV_DIVIDEND_ADDITIONS_AMT,
ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
ALIR_CV_PAIDUP_ADDITIONS_AMT,
ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
ALIR_DIVIDEND_AMT,
ALIR_DIVIDEND_QUALITY_CDE,
ALIR_DIVIDEND_ADDITIONS_AMT,
ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
ALIR_DIVIDEND_AVAILABLE_AMT,
ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
ALIR_MODAL_PREMIUM_AMT,
ALIR_MODAL_PREMIUM_QUALITY_CDE,
ALIR_MONTHLY_PREMIUM_AMT,
ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
ALIR_POLICY_YEAR_NR,
ALIR_PAIDUP_ADDITIONS_AMT,
ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
ALIR_UNSCHEDULED_PREMIUM_AMT,
ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
CV_PD_ALIR_LISR_AMT,
CV_PD_ALIR_LISR_QUALITY_CDE,
LISR_CV_DIVIDEND_ADDITIONS_AMT,
LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
LISR_CV_PAIDUP_ADDITIONS_AMT,
LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
LISR_DIVIDEND_AMT,
LISR_DIVIDEND_QUALITY_CDE,
LISR_DIVIDEND_ADDITIONS_AMT,
LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
LISR_DIVIDEND_AVAILABLE_AMT,
LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
LISR_PAIDUP_ADDITIONS_AMT,
LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
LISR_ANNUAL_PREMIUM_AMT,
LISR_ANNUAL_PREMIUM_QUALITY_CDE,
LISR_FACE_AMT,
LISR_FACE_QUALITY_CDE,
LISR_MONTHLY_PREMIUM_AMT,
LISR_MONTHLY_PREMIUM_QUALITY_CDE,
LISR_MODAL_PREMIUM_AMT,
LISR_MODAL_PREMIUM_QUALITY_CDE,
LISR_RECOMMENDED_PREMIUM_AMT,
LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
LISR_UNSCHEDULED_PREMIUM_AMT,
LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
LTC_PREMIUM_ADJUSTMENT_CDE,
LTC_ACTIVE_CDE,
LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
LTC_DIVIDENDS_BENEFIT_POOL_AMT,
LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
LTC_RETURN_PREMIUM_AMT,
LTC_RETURN_PREMIUM_QUALITY_CDE,
LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
LTC_CURRENT_MMB_AMT,
LTC_CURRENT_MMB_QUALITY_CDE,
LTC_BASE_BENEFIT_POOL_AMT,
LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
LTC_INITIAL_MMB_AMT,
LTC_INITIAL_MMB_QUALITY_CDE,
LTC_MMB_INCREASE_OPTION_IND,
LTC_MMB_INCREASE_AMT,
LTC_MMB_INCREASE_QUALITY_CDE,
LTC_NEXT_MMB_INCREASE_DT,
LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
LTC_RESIDUAL_DEATH_BENEFIT_AMT,
LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
LTC_SELECTED_BENEFIT_PERIOD_NR,
LTC_CLAIM_START_DT,
PAIDUP_ADDITIONS_FACE_AMT,
PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
SL100_SL20P_POLICY_IND,
PALIR_MAX_ANNUAL_PAYMENT_AMT,
PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
PALIR_PREMIUM_START_DT,
PALIR_PREMIUM_END_DT,
PALIR_YTD_PREMIUM_PAID_AMT,
PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
PALIR_ANNUAL_PAYMENT_CNT,
BEGIN_DT,
BEGIN_DTM,
ROW_PROCESS_DTM,
CHECK_SUM,
END_DT,
END_DTM,
RESTRICTED_ROW_IND,
CURRENT_ROW_IND,
LOGICAL_DELETE_IND,
SOURCE_SYSTEM_ID,
AUDIT_ID,
UPDATE_AUDIT_ID,
SOURCE_DELETE_IND,
CREDITING_RT,
CREDITING_RT_START_DT,
CREDITING_RT_END_DT,
CREDITING_REST_PERIOD_DESC,
GROSS_NET_CDE,
END_DT_BOOK_VAL_AMT,
END_DT_MARKET_VAL_AMT,
NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
NEXT_BUSINESS_DAY_CREDITING_RT
)

SELECT
									Staging.dim_agreement_natural_key_hash_uuid,
									Staging.agreement_val_as_of_dt,
									Staging.total_contribution_amt,
									Staging.total_contribution_quality_cde,
									Staging.net_death_benefit_amt,
									Staging.net_death_benefit_quality_cde,
									Staging.net_death_benefit_dt,
									Staging.net_cash_val_amt,
									Staging.net_cash_val_quality_cde,
									Staging.total_account_val_amt,
									Staging.total_account_val_quality_cde,
									Staging.gross_cash_val_amt,
									Staging.gross_cash_val_quality_cde,
									Staging.surrender_charge_amt,
									Staging.surrender_charge_quality_cde,
									Staging.guaranteed_death_benefit_account_val_amt,
									Staging.guaranteed_death_benefit_account_val_quality_cde,
									Staging.deficiency_amt,
									Staging.deficiency_quality_cde,
									Staging.low_death_benefit_amt,
									Staging.low_death_benefit_quality_cde,
									Staging.exchange_1035_amt,
									Staging.exchange_1035_quality_cde,
									Staging.exchange_1035_premium_applied_verification_cde,
									Staging.source_exchange_1035_premium_applied_verification_cde,
									Staging.term_rider_coverage_amt,
									Staging.term_rider_coverage_quality_cde,
									Staging.day_old_ind,
									Staging.source_day_old_ind,
									Staging.arrears_interest_credit_amt,
									Staging.arrears_interest_paid_amt,
									Staging.minimum_cash_required_amt,
									Staging.minimum_cash_required_quality_cde,
									Staging.net_due_amt,
									Staging.net_due_quality_cde,
									Staging.gross_death_benefit_amt,
									Staging.gross_death_benefit_quality_cde,
									Staging.contract_val_amt,
									Staging.contract_val_quality_cde,
									Staging.minimum_account_balance_amt,
									Staging.total_pua_cash_val_amt,
									Staging.total_pua_cash_val_quality_cde,
									Staging.fund_balance_amt,
									Staging.int_ltc_benefit_amt,
									Staging.paidup_available_amt,
									Staging.paidup_available_quality_cde,
									Staging.paidup_face_amt,
									Staging.paidup_face_quality_cde,
									Staging.mgir_rt,
									Staging.mgir_rt_quality_cde,
									Staging.total_first_year_deposit_amt,
									Staging.total_rollover_amt,
									Staging.total_withdrawal_amt,
									Staging.pre_tefra_tamra_amt,
									Staging.post_tefra_tamra_amt,
									Staging.available_withdrawal_fixed_amt,
									Staging.available_withdrawal_variable_amt,
									Staging.next_payout_dt,
									Staging.end_period_certain_dt,
									Staging.last_payout_dt,
									Staging.total_gross_payout_amt,
									Staging.total_net_payout_amt,
									Staging.ytd_gross_payout_amt,
									Staging.ytd_net_payout_amt,
									Staging.ytd_withdrawal_amt,
									Staging.basic_free_withdrawal_amt,
									Staging.additional_free_withdrawal_amt,
									Staging.ytd_net_withdrawal_amt,
									Staging.mva_amt,
									Staging.minimum_surrender_val_amt,
									Staging.contract_guaranteed_interest_rt,
									Staging.gmdb_amt,
									Staging.gmdb_ratchet_amt,
									Staging.gmdb_rollup_amt,
									Staging.gmib_ratchet_amt,
									Staging.gmib_rollup_amt,
									Staging.gmib_dt,
									Staging.net_risk_amt,
									Staging.pytd_withdrawal_amt,
									Staging.net_purchase_payment_amt,
									Staging.covered_contract_val_amt,
									Staging.cytd_charge_amt,
									Staging.rmd_amt,
									Staging.fair_market_val_amt,
									Staging.gmab_base_amt,
									Staging.gmab_next_reset_dt,
									Staging.gmab_last_reset_dt,
									Staging.total_cost_basis_amt,
									Staging.pre_tefra_amt,
									Staging.post_tefra_amt,
									Staging.total_available_withdrawal_amt,
									Staging.rmd_quote_amt,
									Staging.mgir_redetermination_dt,
									Staging.mva_account_val_amt,
									Staging.glwb_benefit_base_amt,
									Staging.glwb_rollup_rt,
									Staging.glwb_benefit_payment_amt,
									Staging.glwb_remaining_benefit_payment_amt,
									Staging.glwb_withdrawal_rt,
									Staging.glwb_lifetime_guarantee_rt,
									Staging.glwb_withdrawal_rt_age_nr,
									Staging.gmsv_interest_rt,
									Staging.glwb_last_step_up_dt,
									Staging.rmd_remaining_amt,
									Staging.accumulated_policy_val_amt,
									Staging.accumulated_policy_val_quality_cde,
									Staging.net_annual_premium_amt,
									Staging.net_annual_premium_quality_cde,
									Staging.interest_on_dividend_accumulation_amt,
									Staging.interest_on_dividend_accumulation_quality_cde,
									Staging.additions_purchase_amt,
									Staging.additions_purchase_quality_cde,
									Staging.supplemental_term_cost_paid_current_amt,
									Staging.supplemental_term_cost_paid_current_quality_cde,
									Staging.basic_amt,
									Staging.basic_quality_cde,
									Staging.total_policy_cash_val_amt,
									Staging.total_policy_cash_val_quality_cde,
									Staging.rp_rn_ri_amt,
									Staging.rp_rn_ri_quality_cde,
									Staging.rafp_irafp_reserve_amt,
									Staging.rafp_irafp_reserve_quality_cde,
									Staging.deviation_or_supplemental_benefit_amt,
									Staging.deviation_or_supplemental_benefit_quality_cde,
									Staging.deferred_paidup_additions_dividend_amt,
									Staging.deferred_paidup_additions_dividend_quality_cde,
									Staging.one_year_term_cost_amt,
									Staging.one_year_term_cost_quality_cde,
									Staging.year_term_agreement_amt,
									Staging.year_term_agreement_quality_cde,
									Staging.gmib_account_val_amt,
									Staging.year_end_val_amt,
									Staging.alir_annual_premium_amt,
									Staging.alir_annual_premium_quality_cde,
									Staging.alir_catchup_available_amt,
									Staging.alir_catchup_available_quality_cde,
									Staging.alir_catchup_applied_amt,
									Staging.alir_catchup_applied_quality_cde,
									Staging.alir_cv_dividend_additions_amt,
									Staging.alir_cv_dividend_additions_quality_cde,
									Staging.alir_cv_paidup_additions_amt,
									Staging.alir_cv_paidup_additions_quality_cde,
									Staging.alir_dividend_amt,
									Staging.alir_dividend_quality_cde,
									Staging.alir_dividend_additions_amt,
									Staging.alir_dividend_additions_quality_cde,
									Staging.alir_dividend_available_amt,
									Staging.alir_dividend_available_quality_cde,
									Staging.alir_modal_nonunderwritten_increase_available_amt,
									Staging.alir_modal_nonunderwritten_increase_available_quality_cde,
									Staging.alir_modal_premium_amt,
									Staging.alir_modal_premium_quality_cde,
									Staging.alir_monthly_premium_amt,
									Staging.alir_monthly_premium_quality_cde,
									Staging.alir_policy_year_nr,
									Staging.alir_paidup_additions_amt,
									Staging.alir_paidup_additions_quality_cde,
									Staging.alir_scheduled_modal_payment_amt,
									Staging.alir_scheduled_modal_payment_quality_cde,
									Staging.alir_scheduled_fractional_payment_amt,
									Staging.alir_scheduled_fractional_payment_quality_cde,
									Staging.alir_unscheduled_premium_amt,
									Staging.alir_unscheduled_premium_quality_cde,
									Staging.alir_current_dividend_earned_by_dividends_amt,
									Staging.alir_current_dividend_earned_by_dividends_quality_cde,
									Staging.alir_current_dividend_earned_by_premium_payments_amt,
									Staging.alir_current_dividend_earned_by_premium_payments_quality_cde,
									Staging.lisr_current_dividend_earned_by_dividends_amt,
									Staging.lisr_current_dividend_earned_by_dividends_quality_cde,
									Staging.lisr_current_dividend_earned_by_premium_payments_amt,
									Staging.lisr_current_dividend_earned_by_premium_payments_quality_cde,
									Staging.cv_pd_alir_lisr_amt,
									Staging.cv_pd_alir_lisr_quality_cde,
									Staging.lisr_cv_dividend_additions_amt,
									Staging.lisr_cv_dividend_additions_quality_cde,
									Staging.lisr_cv_paidup_additions_amt,
									Staging.lisr_cv_paidup_additions_quality_cde,
									Staging.lisr_dividend_amt,
									Staging.lisr_dividend_quality_cde,
									Staging.lisr_dividend_additions_amt,
									Staging.lisr_dividend_additions_quality_cde,
									Staging.lisr_dividend_available_amt,
									Staging.lisr_dividend_available_quality_cde,
									Staging.lisr_paidup_additions_amt,
									Staging.lisr_paidup_additions_quality_cde,
									Staging.lisr_annual_premium_amt,
									Staging.lisr_annual_premium_quality_cde,
									Staging.lisr_face_amt,
									Staging.lisr_face_quality_cde,
									Staging.lisr_monthly_premium_amt,
									Staging.lisr_monthly_premium_quality_cde,
									Staging.lisr_modal_premium_amt,
									Staging.lisr_modal_premium_quality_cde,
									Staging.lisr_recommended_premium_amt,
									Staging.lisr_recommended_premium_quality_cde,
									Staging.lisr_unscheduled_premium_amt,
									Staging.lisr_unscheduled_premium_quality_cde,
									Staging.ltc_premium_adjustment_cde,
									Staging.ltc_active_cde,
									Staging.ltc_advanced_base_paidup_additions_cde,
									Staging.ltc_dividends_benefit_pool_amt,
									Staging.ltc_dividends_benefit_pool_quality_cde,
									Staging.ltc_return_premium_amt,
									Staging.ltc_return_premium_quality_cde,
									Staging.ltc_reduced_paidup_additions_amt,
									Staging.ltc_reduced_paidup_additions_quality_cde,
									Staging.ltc_current_modal_premium_credit_amt,
									Staging.ltc_current_modal_premium_credit_quality_cde,
									Staging.ltc_fractional_premium_credit_amt,
									Staging.ltc_fractional_premium_credit_quality_cde,
									Staging.ltc_current_mmb_amt,
									Staging.ltc_current_mmb_quality_cde,
									Staging.ltc_base_benefit_pool_amt,
									Staging.ltc_base_benefit_pool_quality_cde,
									Staging.ltc_initial_mmb_amt,
									Staging.ltc_initial_mmb_quality_cde,
									Staging.ltc_mmb_increase_option_ind,
									Staging.ltc_mmb_increase_amt,
									Staging.ltc_mmb_increase_quality_cde,
									Staging.ltc_next_mmb_increase_dt,
									Staging.ltc_next_year_premium_credit_amt,
									Staging.ltc_next_year_premium_credit_quality_cde,
									Staging.ltc_residual_death_benefit_amt,
									Staging.ltc_residual_death_benefit_quality_cde,
									Staging.ltc_selected_benefit_period_nr,
									Staging.ltc_claim_start_dt,
									Staging.paidup_additions_face_amt,
									Staging.paidup_additions_face_quality_cde,
									Staging.sl100_sl20p_policy_ind,
									Staging.palir_max_annual_payment_amt,
									Staging.palir_max_annual_payment_quality_cde,
									Staging.palir_premium_start_dt,
									Staging.palir_premium_end_dt,
									Staging.palir_ytd_premium_paid_amt,
									Staging.palir_ytd_premium_paid_quality_cde,
									Staging.palir_previous_year_payment_amt,
									Staging.palir_previous_year_payment_quality_cde,
									Staging.palir_annual_payment_cnt,
									Staging.begin_dt,
									Staging.begin_dtm,
									Staging.row_process_dtm,
									Staging.check_sum,
									Staging.end_dt,
									Staging.end_dtm,
									Staging.restricted_row_ind,
									Staging.current_row_ind,
									Staging.logical_delete_ind,
									Staging.source_system_id,
									Staging.audit_id,
									Staging.audit_id,
									Staging.source_delete_ind,
									staging.crediting_rt,
									staging.crediting_rt_start_dt,
									staging.crediting_rt_end_dt,
									staging.crediting_rest_period_desc,
									staging.gross_net_cde,
									staging.end_dt_book_val_amt,
									staging.end_dt_market_val_amt,
									staging.next_month_first_business_day_dt,
									staging.next_business_day_crediting_rt
FROM edw_staging.aifrps_attr_agreement_values_pre_work Staging
WHERE
                Staging.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID NOT IN
                        (SELECT DIM_AGREEMENT_NATURAL_KEY_HASH_UUID
                            FROM {{target_schema}}.ATTR_AGREEMENT_VALUES
							WHERE SOURCE_SYSTEM_ID in ('72','266')
                        )

;

-- Step3
/*  WORK TABLE - UPDATE TGT RECORD
 *
 * THIS SCRIPT FINDS RECORDS WHERE THE NEW RECORD FROM THE SOURCE HAS A DIFFERENT CHECK_SUM THAN THE CURRENT TARGET RECORD.
 * THE CURRENT RECORD IN THE TARGET WILL BE ENDED SINCE THE SOURCE RECORD WILL BE INSERTED IN THE NEXT STEP.
 *
*/

INSERT INTO edw_work.aifrps_attr_agreement_values
(
DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
AGREEMENT_VAL_AS_OF_DT,
TOTAL_CONTRIBUTION_AMT,
TOTAL_CONTRIBUTION_QUALITY_CDE,
NET_DEATH_BENEFIT_AMT,
NET_DEATH_BENEFIT_QUALITY_CDE,
NET_DEATH_BENEFIT_DT,
NET_CASH_VAL_AMT,
NET_CASH_VAL_QUALITY_CDE,
TOTAL_ACCOUNT_VAL_AMT,
TOTAL_ACCOUNT_VAL_QUALITY_CDE,
GROSS_CASH_VAL_AMT,
GROSS_CASH_VAL_QUALITY_CDE,
SURRENDER_CHARGE_AMT,
SURRENDER_CHARGE_QUALITY_CDE,
GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
DEFICIENCY_AMT,
DEFICIENCY_QUALITY_CDE,
LOW_DEATH_BENEFIT_AMT,
LOW_DEATH_BENEFIT_QUALITY_CDE,
EXCHANGE_1035_AMT,
EXCHANGE_1035_QUALITY_CDE,
EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
TERM_RIDER_COVERAGE_AMT,
TERM_RIDER_COVERAGE_QUALITY_CDE,
DAY_OLD_IND,
SOURCE_DAY_OLD_IND,
ARREARS_INTEREST_CREDIT_AMT,
ARREARS_INTEREST_PAID_AMT,
MINIMUM_CASH_REQUIRED_AMT,
MINIMUM_CASH_REQUIRED_QUALITY_CDE,
NET_DUE_AMT,
NET_DUE_QUALITY_CDE,
GROSS_DEATH_BENEFIT_AMT,
GROSS_DEATH_BENEFIT_QUALITY_CDE,
CONTRACT_VAL_AMT,
CONTRACT_VAL_QUALITY_CDE,
MINIMUM_ACCOUNT_BALANCE_AMT,
TOTAL_PUA_CASH_VAL_AMT,
TOTAL_PUA_CASH_VAL_QUALITY_CDE,
FUND_BALANCE_AMT,
INT_LTC_BENEFIT_AMT,
PAIDUP_AVAILABLE_AMT,
PAIDUP_AVAILABLE_QUALITY_CDE,
PAIDUP_FACE_AMT,
PAIDUP_FACE_QUALITY_CDE,
MGIR_RT,
MGIR_RT_QUALITY_CDE,
TOTAL_FIRST_YEAR_DEPOSIT_AMT,
TOTAL_ROLLOVER_AMT,
TOTAL_WITHDRAWAL_AMT,
PRE_TEFRA_TAMRA_AMT,
POST_TEFRA_TAMRA_AMT,
AVAILABLE_WITHDRAWAL_FIXED_AMT,
AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
NEXT_PAYOUT_DT,
END_PERIOD_CERTAIN_DT,
LAST_PAYOUT_DT,
TOTAL_GROSS_PAYOUT_AMT,
TOTAL_NET_PAYOUT_AMT,
YTD_GROSS_PAYOUT_AMT,
YTD_NET_PAYOUT_AMT,
YTD_WITHDRAWAL_AMT,
BASIC_FREE_WITHDRAWAL_AMT,
ADDITIONAL_FREE_WITHDRAWAL_AMT,
YTD_NET_WITHDRAWAL_AMT,
MVA_AMT,
MINIMUM_SURRENDER_VAL_AMT,
CONTRACT_GUARANTEED_INTEREST_RT,
GMDB_AMT,
GMDB_RATCHET_AMT,
GMDB_ROLLUP_AMT,
GMIB_RATCHET_AMT,
GMIB_ROLLUP_AMT,
GMIB_DT,
NET_RISK_AMT,
PYTD_WITHDRAWAL_AMT,
NET_PURCHASE_PAYMENT_AMT,
COVERED_CONTRACT_VAL_AMT,
CYTD_CHARGE_AMT,
RMD_AMT,
FAIR_MARKET_VAL_AMT,
GMAB_BASE_AMT,
GMAB_NEXT_RESET_DT,
GMAB_LAST_RESET_DT,
TOTAL_COST_BASIS_AMT,
PRE_TEFRA_AMT,
POST_TEFRA_AMT,
TOTAL_AVAILABLE_WITHDRAWAL_AMT,
RMD_QUOTE_AMT,
MGIR_REDETERMINATION_DT,
MVA_ACCOUNT_VAL_AMT,
GLWB_BENEFIT_BASE_AMT,
GLWB_ROLLUP_RT,
GLWB_BENEFIT_PAYMENT_AMT,
GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
GLWB_WITHDRAWAL_RT,
GLWB_LIFETIME_GUARANTEE_RT,
GLWB_WITHDRAWAL_RT_AGE_NR,
GMSV_INTEREST_RT,
GLWB_LAST_STEP_UP_DT,
RMD_REMAINING_AMT,
ACCUMULATED_POLICY_VAL_AMT,
ACCUMULATED_POLICY_VAL_QUALITY_CDE,
NET_ANNUAL_PREMIUM_AMT,
NET_ANNUAL_PREMIUM_QUALITY_CDE,
INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
ADDITIONS_PURCHASE_AMT,
ADDITIONS_PURCHASE_QUALITY_CDE,
SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
BASIC_AMT,
BASIC_QUALITY_CDE,
TOTAL_POLICY_CASH_VAL_AMT,
TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
RP_RN_RI_AMT,
RP_RN_RI_QUALITY_CDE,
RAFP_IRAFP_RESERVE_AMT,
RAFP_IRAFP_RESERVE_QUALITY_CDE,
DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
ONE_YEAR_TERM_COST_AMT,
ONE_YEAR_TERM_COST_QUALITY_CDE,
YEAR_TERM_AGREEMENT_AMT,
YEAR_TERM_AGREEMENT_QUALITY_CDE,
GMIB_ACCOUNT_VAL_AMT,
YEAR_END_VAL_AMT,
ALIR_ANNUAL_PREMIUM_AMT,
ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
ALIR_CATCHUP_AVAILABLE_AMT,
ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
ALIR_CATCHUP_APPLIED_AMT,
ALIR_CATCHUP_APPLIED_QUALITY_CDE,
ALIR_CV_DIVIDEND_ADDITIONS_AMT,
ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
ALIR_CV_PAIDUP_ADDITIONS_AMT,
ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
ALIR_DIVIDEND_AMT,
ALIR_DIVIDEND_QUALITY_CDE,
ALIR_DIVIDEND_ADDITIONS_AMT,
ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
ALIR_DIVIDEND_AVAILABLE_AMT,
ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
ALIR_MODAL_PREMIUM_AMT,
ALIR_MODAL_PREMIUM_QUALITY_CDE,
ALIR_MONTHLY_PREMIUM_AMT,
ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
ALIR_POLICY_YEAR_NR,
ALIR_PAIDUP_ADDITIONS_AMT,
ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
ALIR_UNSCHEDULED_PREMIUM_AMT,
ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
CV_PD_ALIR_LISR_AMT,
CV_PD_ALIR_LISR_QUALITY_CDE,
LISR_CV_DIVIDEND_ADDITIONS_AMT,
LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
LISR_CV_PAIDUP_ADDITIONS_AMT,
LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
LISR_DIVIDEND_AMT,
LISR_DIVIDEND_QUALITY_CDE,
LISR_DIVIDEND_ADDITIONS_AMT,
LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
LISR_DIVIDEND_AVAILABLE_AMT,
LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
LISR_PAIDUP_ADDITIONS_AMT,
LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
LISR_ANNUAL_PREMIUM_AMT,
LISR_ANNUAL_PREMIUM_QUALITY_CDE,
LISR_FACE_AMT,
LISR_FACE_QUALITY_CDE,
LISR_MONTHLY_PREMIUM_AMT,
LISR_MONTHLY_PREMIUM_QUALITY_CDE,
LISR_MODAL_PREMIUM_AMT,
LISR_MODAL_PREMIUM_QUALITY_CDE,
LISR_RECOMMENDED_PREMIUM_AMT,
LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
LISR_UNSCHEDULED_PREMIUM_AMT,
LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
LTC_PREMIUM_ADJUSTMENT_CDE,
LTC_ACTIVE_CDE,
LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
LTC_DIVIDENDS_BENEFIT_POOL_AMT,
LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
LTC_RETURN_PREMIUM_AMT,
LTC_RETURN_PREMIUM_QUALITY_CDE,
LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
LTC_CURRENT_MMB_AMT,
LTC_CURRENT_MMB_QUALITY_CDE,
LTC_BASE_BENEFIT_POOL_AMT,
LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
LTC_INITIAL_MMB_AMT,
LTC_INITIAL_MMB_QUALITY_CDE,
LTC_MMB_INCREASE_OPTION_IND,
LTC_MMB_INCREASE_AMT,
LTC_MMB_INCREASE_QUALITY_CDE,
LTC_NEXT_MMB_INCREASE_DT,
LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
LTC_RESIDUAL_DEATH_BENEFIT_AMT,
LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
LTC_SELECTED_BENEFIT_PERIOD_NR,
LTC_CLAIM_START_DT,
PAIDUP_ADDITIONS_FACE_AMT,
PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
SL100_SL20P_POLICY_IND,
PALIR_MAX_ANNUAL_PAYMENT_AMT,
PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
PALIR_PREMIUM_START_DT,
PALIR_PREMIUM_END_DT,
PALIR_YTD_PREMIUM_PAID_AMT,
PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
PALIR_ANNUAL_PAYMENT_CNT,
BEGIN_DT,
BEGIN_DTM,
ROW_PROCESS_DTM,
CHECK_SUM,
END_DT,
END_DTM,
RESTRICTED_ROW_IND,
CURRENT_ROW_IND,
LOGICAL_DELETE_IND,
SOURCE_SYSTEM_ID,
AUDIT_ID,
UPDATE_AUDIT_ID,
SOURCE_DELETE_IND,
CREDITING_RT,
CREDITING_RT_START_DT,
CREDITING_RT_END_DT,
CREDITING_REST_PERIOD_DESC,
GROSS_NET_CDE,
END_DT_BOOK_VAL_AMT,
END_DT_MARKET_VAL_AMT,
NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
NEXT_BUSINESS_DAY_CREDITING_RT
)

SELECT
									TGT.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
									TGT.AGREEMENT_VAL_AS_OF_DT,
									TGT.TOTAL_CONTRIBUTION_AMT,
									TGT.TOTAL_CONTRIBUTION_QUALITY_CDE,
									TGT.NET_DEATH_BENEFIT_AMT,
									TGT.NET_DEATH_BENEFIT_QUALITY_CDE,
									TGT.NET_DEATH_BENEFIT_DT,
									TGT.NET_CASH_VAL_AMT,
									TGT.NET_CASH_VAL_QUALITY_CDE,
									TGT.TOTAL_ACCOUNT_VAL_AMT,
									TGT.TOTAL_ACCOUNT_VAL_QUALITY_CDE,
									TGT.GROSS_CASH_VAL_AMT,
									TGT.GROSS_CASH_VAL_QUALITY_CDE,
									TGT.SURRENDER_CHARGE_AMT,
									TGT.SURRENDER_CHARGE_QUALITY_CDE,
									TGT.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
									TGT.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
									TGT.DEFICIENCY_AMT,
									TGT.DEFICIENCY_QUALITY_CDE,
									TGT.LOW_DEATH_BENEFIT_AMT,
									TGT.LOW_DEATH_BENEFIT_QUALITY_CDE,
									TGT.EXCHANGE_1035_AMT,
									TGT.EXCHANGE_1035_QUALITY_CDE,
									TGT.EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
									TGT.SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
									TGT.TERM_RIDER_COVERAGE_AMT,
									TGT.TERM_RIDER_COVERAGE_QUALITY_CDE,
									TGT.DAY_OLD_IND,
									TGT.SOURCE_DAY_OLD_IND,
									TGT.ARREARS_INTEREST_CREDIT_AMT,
									TGT.ARREARS_INTEREST_PAID_AMT,
									TGT.MINIMUM_CASH_REQUIRED_AMT,
									TGT.MINIMUM_CASH_REQUIRED_QUALITY_CDE,
									TGT.NET_DUE_AMT,
									TGT.NET_DUE_QUALITY_CDE,
									TGT.GROSS_DEATH_BENEFIT_AMT,
									TGT.GROSS_DEATH_BENEFIT_QUALITY_CDE,
									TGT.CONTRACT_VAL_AMT,
									TGT.CONTRACT_VAL_QUALITY_CDE,
									TGT.MINIMUM_ACCOUNT_BALANCE_AMT,
									TGT.TOTAL_PUA_CASH_VAL_AMT,
									TGT.TOTAL_PUA_CASH_VAL_QUALITY_CDE,
									TGT.FUND_BALANCE_AMT,
									TGT.INT_LTC_BENEFIT_AMT,
									TGT.PAIDUP_AVAILABLE_AMT,
									TGT.PAIDUP_AVAILABLE_QUALITY_CDE,
									TGT.PAIDUP_FACE_AMT,
									TGT.PAIDUP_FACE_QUALITY_CDE,
									TGT.MGIR_RT,
									TGT.MGIR_RT_QUALITY_CDE,
									TGT.TOTAL_FIRST_YEAR_DEPOSIT_AMT,
									TGT.TOTAL_ROLLOVER_AMT,
									TGT.TOTAL_WITHDRAWAL_AMT,
									TGT.PRE_TEFRA_TAMRA_AMT,
									TGT.POST_TEFRA_TAMRA_AMT,
									TGT.AVAILABLE_WITHDRAWAL_FIXED_AMT,
									TGT.AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
									TGT.NEXT_PAYOUT_DT,
									TGT.END_PERIOD_CERTAIN_DT,
									TGT.LAST_PAYOUT_DT,
									TGT.TOTAL_GROSS_PAYOUT_AMT,
									TGT.TOTAL_NET_PAYOUT_AMT,
									TGT.YTD_GROSS_PAYOUT_AMT,
									TGT.YTD_NET_PAYOUT_AMT,
									TGT.YTD_WITHDRAWAL_AMT,
									TGT.BASIC_FREE_WITHDRAWAL_AMT,
									TGT.ADDITIONAL_FREE_WITHDRAWAL_AMT,
									TGT.YTD_NET_WITHDRAWAL_AMT,
									TGT.MVA_AMT,
									TGT.MINIMUM_SURRENDER_VAL_AMT,
									TGT.CONTRACT_GUARANTEED_INTEREST_RT,
									TGT.GMDB_AMT,
									TGT.GMDB_RATCHET_AMT,
									TGT.GMDB_ROLLUP_AMT,
									TGT.GMIB_RATCHET_AMT,
									TGT.GMIB_ROLLUP_AMT,
									TGT.GMIB_DT,
									TGT.NET_RISK_AMT,
									TGT.PYTD_WITHDRAWAL_AMT,
									TGT.NET_PURCHASE_PAYMENT_AMT,
									TGT.COVERED_CONTRACT_VAL_AMT,
									TGT.CYTD_CHARGE_AMT,
									TGT.RMD_AMT,
									TGT.FAIR_MARKET_VAL_AMT,
									TGT.GMAB_BASE_AMT,
									TGT.GMAB_NEXT_RESET_DT,
									TGT.GMAB_LAST_RESET_DT,
									TGT.TOTAL_COST_BASIS_AMT,
									TGT.PRE_TEFRA_AMT,
									TGT.POST_TEFRA_AMT,
									TGT.TOTAL_AVAILABLE_WITHDRAWAL_AMT,
									TGT.RMD_QUOTE_AMT,
									TGT.MGIR_REDETERMINATION_DT,
									TGT.MVA_ACCOUNT_VAL_AMT,
									TGT.GLWB_BENEFIT_BASE_AMT,
									TGT.GLWB_ROLLUP_RT,
									TGT.GLWB_BENEFIT_PAYMENT_AMT,
									TGT.GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
									TGT.GLWB_WITHDRAWAL_RT,
									TGT.GLWB_LIFETIME_GUARANTEE_RT,
									TGT.GLWB_WITHDRAWAL_RT_AGE_NR,
									TGT.GMSV_INTEREST_RT,
									TGT.GLWB_LAST_STEP_UP_DT,
									TGT.RMD_REMAINING_AMT,
									TGT.ACCUMULATED_POLICY_VAL_AMT,
									TGT.ACCUMULATED_POLICY_VAL_QUALITY_CDE,
									TGT.NET_ANNUAL_PREMIUM_AMT,
									TGT.NET_ANNUAL_PREMIUM_QUALITY_CDE,
									TGT.INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
									TGT.INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
									TGT.ADDITIONS_PURCHASE_AMT,
									TGT.ADDITIONS_PURCHASE_QUALITY_CDE,
									TGT.SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
									TGT.SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
									TGT.BASIC_AMT,
									TGT.BASIC_QUALITY_CDE,
									TGT.TOTAL_POLICY_CASH_VAL_AMT,
									TGT.TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
									TGT.RP_RN_RI_AMT,
									TGT.RP_RN_RI_QUALITY_CDE,
									TGT.RAFP_IRAFP_RESERVE_AMT,
									TGT.RAFP_IRAFP_RESERVE_QUALITY_CDE,
									TGT.DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
									TGT.DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
									TGT.DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
									TGT.DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
									TGT.ONE_YEAR_TERM_COST_AMT,
									TGT.ONE_YEAR_TERM_COST_QUALITY_CDE,
									TGT.YEAR_TERM_AGREEMENT_AMT,
									TGT.YEAR_TERM_AGREEMENT_QUALITY_CDE,
									TGT.GMIB_ACCOUNT_VAL_AMT,
									TGT.YEAR_END_VAL_AMT,
									TGT.ALIR_ANNUAL_PREMIUM_AMT,
									TGT.ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
									TGT.ALIR_CATCHUP_AVAILABLE_AMT,
									TGT.ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
									TGT.ALIR_CATCHUP_APPLIED_AMT,
									TGT.ALIR_CATCHUP_APPLIED_QUALITY_CDE,
									TGT.ALIR_CV_DIVIDEND_ADDITIONS_AMT,
									TGT.ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
									TGT.ALIR_CV_PAIDUP_ADDITIONS_AMT,
									TGT.ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
									TGT.ALIR_DIVIDEND_AMT,
									TGT.ALIR_DIVIDEND_QUALITY_CDE,
									TGT.ALIR_DIVIDEND_ADDITIONS_AMT,
									TGT.ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
									TGT.ALIR_DIVIDEND_AVAILABLE_AMT,
									TGT.ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
									TGT.ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
									TGT.ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
									TGT.ALIR_MODAL_PREMIUM_AMT,
									TGT.ALIR_MODAL_PREMIUM_QUALITY_CDE,
									TGT.ALIR_MONTHLY_PREMIUM_AMT,
									TGT.ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
									TGT.ALIR_POLICY_YEAR_NR,
									TGT.ALIR_PAIDUP_ADDITIONS_AMT,
									TGT.ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
									TGT.ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
									TGT.ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
									TGT.ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
									TGT.ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
									TGT.ALIR_UNSCHEDULED_PREMIUM_AMT,
									TGT.ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
									TGT.ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
									TGT.ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
									TGT.ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
									TGT.ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
									TGT.LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
									TGT.LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
									TGT.LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
									TGT.LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
									TGT.CV_PD_ALIR_LISR_AMT,
									TGT.CV_PD_ALIR_LISR_QUALITY_CDE,
									TGT.LISR_CV_DIVIDEND_ADDITIONS_AMT,
									TGT.LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
									TGT.LISR_CV_PAIDUP_ADDITIONS_AMT,
									TGT.LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
									TGT.LISR_DIVIDEND_AMT,
									TGT.LISR_DIVIDEND_QUALITY_CDE,
									TGT.LISR_DIVIDEND_ADDITIONS_AMT,
									TGT.LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
									TGT.LISR_DIVIDEND_AVAILABLE_AMT,
									TGT.LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
									TGT.LISR_PAIDUP_ADDITIONS_AMT,
									TGT.LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
									TGT.LISR_ANNUAL_PREMIUM_AMT,
									TGT.LISR_ANNUAL_PREMIUM_QUALITY_CDE,
									TGT.LISR_FACE_AMT,
									TGT.LISR_FACE_QUALITY_CDE,
									TGT.LISR_MONTHLY_PREMIUM_AMT,
									TGT.LISR_MONTHLY_PREMIUM_QUALITY_CDE,
									TGT.LISR_MODAL_PREMIUM_AMT,
									TGT.LISR_MODAL_PREMIUM_QUALITY_CDE,
									TGT.LISR_RECOMMENDED_PREMIUM_AMT,
									TGT.LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
									TGT.LISR_UNSCHEDULED_PREMIUM_AMT,
									TGT.LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
									TGT.LTC_PREMIUM_ADJUSTMENT_CDE,
									TGT.LTC_ACTIVE_CDE,
									TGT.LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
									TGT.LTC_DIVIDENDS_BENEFIT_POOL_AMT,
									TGT.LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
									TGT.LTC_RETURN_PREMIUM_AMT,
									TGT.LTC_RETURN_PREMIUM_QUALITY_CDE,
									TGT.LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
									TGT.LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
									TGT.LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
									TGT.LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
									TGT.LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
									TGT.LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
									TGT.LTC_CURRENT_MMB_AMT,
									TGT.LTC_CURRENT_MMB_QUALITY_CDE,
									TGT.LTC_BASE_BENEFIT_POOL_AMT,
									TGT.LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
									TGT.LTC_INITIAL_MMB_AMT,
									TGT.LTC_INITIAL_MMB_QUALITY_CDE,
									TGT.LTC_MMB_INCREASE_OPTION_IND,
									TGT.LTC_MMB_INCREASE_AMT,
									TGT.LTC_MMB_INCREASE_QUALITY_CDE,
									TGT.LTC_NEXT_MMB_INCREASE_DT,
									TGT.LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
									TGT.LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
									TGT.LTC_RESIDUAL_DEATH_BENEFIT_AMT,
									TGT.LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
									TGT.LTC_SELECTED_BENEFIT_PERIOD_NR,
									TGT.LTC_CLAIM_START_DT,
									TGT.PAIDUP_ADDITIONS_FACE_AMT,
									TGT.PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
									TGT.SL100_SL20P_POLICY_IND,
									TGT.PALIR_MAX_ANNUAL_PAYMENT_AMT,
									TGT.PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
									TGT.PALIR_PREMIUM_START_DT,
									TGT.PALIR_PREMIUM_END_DT,
									TGT.PALIR_YTD_PREMIUM_PAID_AMT,
									TGT.PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
									TGT.PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
									TGT.PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
									TGT.PALIR_ANNUAL_PAYMENT_CNT,
									TGT.BEGIN_DT,
									TGT.BEGIN_DTM,
									CURRENT_TIMESTAMP(6)        AS ROW_PROCESS_DTM,
									TGT.CHECK_SUM,
									SRC.BEGIN_DT - INTERVAL '1' DAY AS END_DT,
									SRC.BEGIN_DTM - INTERVAL '1' SECOND AS END_DTM,
									TGT.RESTRICTED_ROW_IND,
									FALSE AS CURRENT_ROW_IND,
									TGT.LOGICAL_DELETE_IND,
									TGT.SOURCE_SYSTEM_ID,
									TGT.AUDIT_ID,
									:audit_id AS UPDATE_AUDIT_ID,
									TGT.SOURCE_DELETE_IND,
									TGT.CREDITING_RT,
									TGT.CREDITING_RT_START_DT,
									TGT.CREDITING_RT_END_DT,
									TGT.CREDITING_REST_PERIOD_DESC,
									TGT.GROSS_NET_CDE,
									TGT.END_DT_BOOK_VAL_AMT,
									TGT.END_DT_MARKET_VAL_AMT,
									TGT.NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
									TGT.NEXT_BUSINESS_DAY_CREDITING_RT
FROM {{target_schema}}.ATTR_AGREEMENT_VALUES TGT
LEFT JOIN edw_staging.aifrps_attr_agreement_values_pre_work SRC
ON      SRC.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID = TGT.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID
    AND TGT.CURRENT_ROW_IND = TRUE
	AND TGT.SOURCE_SYSTEM_ID IN ('72','266')
WHERE
        SRC.CHECK_SUM <> TGT.CHECK_SUM;

-- Step4
/* 
 * WORK TABLE - UPDATE WHERE RECORD ALREADY EXISTS IN TARGET
 *
 *
*/
INSERT INTO edw_work.aifrps_attr_agreement_values
(
DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
AGREEMENT_VAL_AS_OF_DT,
TOTAL_CONTRIBUTION_AMT,
TOTAL_CONTRIBUTION_QUALITY_CDE,
NET_DEATH_BENEFIT_AMT,
NET_DEATH_BENEFIT_QUALITY_CDE,
NET_DEATH_BENEFIT_DT,
NET_CASH_VAL_AMT,
NET_CASH_VAL_QUALITY_CDE,
TOTAL_ACCOUNT_VAL_AMT,
TOTAL_ACCOUNT_VAL_QUALITY_CDE,
GROSS_CASH_VAL_AMT,
GROSS_CASH_VAL_QUALITY_CDE,
SURRENDER_CHARGE_AMT,
SURRENDER_CHARGE_QUALITY_CDE,
GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
DEFICIENCY_AMT,
DEFICIENCY_QUALITY_CDE,
LOW_DEATH_BENEFIT_AMT,
LOW_DEATH_BENEFIT_QUALITY_CDE,
EXCHANGE_1035_AMT,
EXCHANGE_1035_QUALITY_CDE,
EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
TERM_RIDER_COVERAGE_AMT,
TERM_RIDER_COVERAGE_QUALITY_CDE,
DAY_OLD_IND,
SOURCE_DAY_OLD_IND,
ARREARS_INTEREST_CREDIT_AMT,
ARREARS_INTEREST_PAID_AMT,
MINIMUM_CASH_REQUIRED_AMT,
MINIMUM_CASH_REQUIRED_QUALITY_CDE,
NET_DUE_AMT,
NET_DUE_QUALITY_CDE,
GROSS_DEATH_BENEFIT_AMT,
GROSS_DEATH_BENEFIT_QUALITY_CDE,
CONTRACT_VAL_AMT,
CONTRACT_VAL_QUALITY_CDE,
MINIMUM_ACCOUNT_BALANCE_AMT,
TOTAL_PUA_CASH_VAL_AMT,
TOTAL_PUA_CASH_VAL_QUALITY_CDE,
FUND_BALANCE_AMT,
INT_LTC_BENEFIT_AMT,
PAIDUP_AVAILABLE_AMT,
PAIDUP_AVAILABLE_QUALITY_CDE,
PAIDUP_FACE_AMT,
PAIDUP_FACE_QUALITY_CDE,
MGIR_RT,
MGIR_RT_QUALITY_CDE,
TOTAL_FIRST_YEAR_DEPOSIT_AMT,
TOTAL_ROLLOVER_AMT,
TOTAL_WITHDRAWAL_AMT,
PRE_TEFRA_TAMRA_AMT,
POST_TEFRA_TAMRA_AMT,
AVAILABLE_WITHDRAWAL_FIXED_AMT,
AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
NEXT_PAYOUT_DT,
END_PERIOD_CERTAIN_DT,
LAST_PAYOUT_DT,
TOTAL_GROSS_PAYOUT_AMT,
TOTAL_NET_PAYOUT_AMT,
YTD_GROSS_PAYOUT_AMT,
YTD_NET_PAYOUT_AMT,
YTD_WITHDRAWAL_AMT,
BASIC_FREE_WITHDRAWAL_AMT,
ADDITIONAL_FREE_WITHDRAWAL_AMT,
YTD_NET_WITHDRAWAL_AMT,
MVA_AMT,
MINIMUM_SURRENDER_VAL_AMT,
CONTRACT_GUARANTEED_INTEREST_RT,
GMDB_AMT,
GMDB_RATCHET_AMT,
GMDB_ROLLUP_AMT,
GMIB_RATCHET_AMT,
GMIB_ROLLUP_AMT,
GMIB_DT,
NET_RISK_AMT,
PYTD_WITHDRAWAL_AMT,
NET_PURCHASE_PAYMENT_AMT,
COVERED_CONTRACT_VAL_AMT,
CYTD_CHARGE_AMT,
RMD_AMT,
FAIR_MARKET_VAL_AMT,
GMAB_BASE_AMT,
GMAB_NEXT_RESET_DT,
GMAB_LAST_RESET_DT,
TOTAL_COST_BASIS_AMT,
PRE_TEFRA_AMT,
POST_TEFRA_AMT,
TOTAL_AVAILABLE_WITHDRAWAL_AMT,
RMD_QUOTE_AMT,
MGIR_REDETERMINATION_DT,
MVA_ACCOUNT_VAL_AMT,
GLWB_BENEFIT_BASE_AMT,
GLWB_ROLLUP_RT,
GLWB_BENEFIT_PAYMENT_AMT,
GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
GLWB_WITHDRAWAL_RT,
GLWB_LIFETIME_GUARANTEE_RT,
GLWB_WITHDRAWAL_RT_AGE_NR,
GMSV_INTEREST_RT,
GLWB_LAST_STEP_UP_DT,
RMD_REMAINING_AMT,
ACCUMULATED_POLICY_VAL_AMT,
ACCUMULATED_POLICY_VAL_QUALITY_CDE,
NET_ANNUAL_PREMIUM_AMT,
NET_ANNUAL_PREMIUM_QUALITY_CDE,
INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
ADDITIONS_PURCHASE_AMT,
ADDITIONS_PURCHASE_QUALITY_CDE,
SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
BASIC_AMT,
BASIC_QUALITY_CDE,
TOTAL_POLICY_CASH_VAL_AMT,
TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
RP_RN_RI_AMT,
RP_RN_RI_QUALITY_CDE,
RAFP_IRAFP_RESERVE_AMT,
RAFP_IRAFP_RESERVE_QUALITY_CDE,
DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
ONE_YEAR_TERM_COST_AMT,
ONE_YEAR_TERM_COST_QUALITY_CDE,
YEAR_TERM_AGREEMENT_AMT,
YEAR_TERM_AGREEMENT_QUALITY_CDE,
GMIB_ACCOUNT_VAL_AMT,
YEAR_END_VAL_AMT,
ALIR_ANNUAL_PREMIUM_AMT,
ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
ALIR_CATCHUP_AVAILABLE_AMT,
ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
ALIR_CATCHUP_APPLIED_AMT,
ALIR_CATCHUP_APPLIED_QUALITY_CDE,
ALIR_CV_DIVIDEND_ADDITIONS_AMT,
ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
ALIR_CV_PAIDUP_ADDITIONS_AMT,
ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
ALIR_DIVIDEND_AMT,
ALIR_DIVIDEND_QUALITY_CDE,
ALIR_DIVIDEND_ADDITIONS_AMT,
ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
ALIR_DIVIDEND_AVAILABLE_AMT,
ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
ALIR_MODAL_PREMIUM_AMT,
ALIR_MODAL_PREMIUM_QUALITY_CDE,
ALIR_MONTHLY_PREMIUM_AMT,
ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
ALIR_POLICY_YEAR_NR,
ALIR_PAIDUP_ADDITIONS_AMT,
ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
ALIR_UNSCHEDULED_PREMIUM_AMT,
ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
CV_PD_ALIR_LISR_AMT,
CV_PD_ALIR_LISR_QUALITY_CDE,
LISR_CV_DIVIDEND_ADDITIONS_AMT,
LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
LISR_CV_PAIDUP_ADDITIONS_AMT,
LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
LISR_DIVIDEND_AMT,
LISR_DIVIDEND_QUALITY_CDE,
LISR_DIVIDEND_ADDITIONS_AMT,
LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
LISR_DIVIDEND_AVAILABLE_AMT,
LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
LISR_PAIDUP_ADDITIONS_AMT,
LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
LISR_ANNUAL_PREMIUM_AMT,
LISR_ANNUAL_PREMIUM_QUALITY_CDE,
LISR_FACE_AMT,
LISR_FACE_QUALITY_CDE,
LISR_MONTHLY_PREMIUM_AMT,
LISR_MONTHLY_PREMIUM_QUALITY_CDE,
LISR_MODAL_PREMIUM_AMT,
LISR_MODAL_PREMIUM_QUALITY_CDE,
LISR_RECOMMENDED_PREMIUM_AMT,
LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
LISR_UNSCHEDULED_PREMIUM_AMT,
LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
LTC_PREMIUM_ADJUSTMENT_CDE,
LTC_ACTIVE_CDE,
LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
LTC_DIVIDENDS_BENEFIT_POOL_AMT,
LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
LTC_RETURN_PREMIUM_AMT,
LTC_RETURN_PREMIUM_QUALITY_CDE,
LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
LTC_CURRENT_MMB_AMT,
LTC_CURRENT_MMB_QUALITY_CDE,
LTC_BASE_BENEFIT_POOL_AMT,
LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
LTC_INITIAL_MMB_AMT,
LTC_INITIAL_MMB_QUALITY_CDE,
LTC_MMB_INCREASE_OPTION_IND,
LTC_MMB_INCREASE_AMT,
LTC_MMB_INCREASE_QUALITY_CDE,
LTC_NEXT_MMB_INCREASE_DT,
LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
LTC_RESIDUAL_DEATH_BENEFIT_AMT,
LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
LTC_SELECTED_BENEFIT_PERIOD_NR,
LTC_CLAIM_START_DT,
PAIDUP_ADDITIONS_FACE_AMT,
PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
SL100_SL20P_POLICY_IND,
PALIR_MAX_ANNUAL_PAYMENT_AMT,
PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
PALIR_PREMIUM_START_DT,
PALIR_PREMIUM_END_DT,
PALIR_YTD_PREMIUM_PAID_AMT,
PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
PALIR_ANNUAL_PAYMENT_CNT,
BEGIN_DT,
BEGIN_DTM,
ROW_PROCESS_DTM,
CHECK_SUM,
END_DT,
END_DTM,
RESTRICTED_ROW_IND,
CURRENT_ROW_IND,
LOGICAL_DELETE_IND,
SOURCE_SYSTEM_ID,
AUDIT_ID,
UPDATE_AUDIT_ID,
SOURCE_DELETE_IND,
CREDITING_RT,
CREDITING_RT_START_DT,
CREDITING_RT_END_DT,
CREDITING_REST_PERIOD_DESC,
GROSS_NET_CDE,
END_DT_BOOK_VAL_AMT,
END_DT_MARKET_VAL_AMT,
NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
NEXT_BUSINESS_DAY_CREDITING_RT
)
SELECT
									SRC.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
									SRC.AGREEMENT_VAL_AS_OF_DT,
									SRC.TOTAL_CONTRIBUTION_AMT,
									SRC.TOTAL_CONTRIBUTION_QUALITY_CDE,
									SRC.NET_DEATH_BENEFIT_AMT,
									SRC.NET_DEATH_BENEFIT_QUALITY_CDE,
									SRC.NET_DEATH_BENEFIT_DT,
									SRC.NET_CASH_VAL_AMT,
									SRC.NET_CASH_VAL_QUALITY_CDE,
									SRC.TOTAL_ACCOUNT_VAL_AMT,
									SRC.TOTAL_ACCOUNT_VAL_QUALITY_CDE,
									SRC.GROSS_CASH_VAL_AMT,
									SRC.GROSS_CASH_VAL_QUALITY_CDE,
									SRC.SURRENDER_CHARGE_AMT,
									SRC.SURRENDER_CHARGE_QUALITY_CDE,
									SRC.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
									SRC.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
									SRC.DEFICIENCY_AMT,
									SRC.DEFICIENCY_QUALITY_CDE,
									SRC.LOW_DEATH_BENEFIT_AMT,
									SRC.LOW_DEATH_BENEFIT_QUALITY_CDE,
									SRC.EXCHANGE_1035_AMT,
									SRC.EXCHANGE_1035_QUALITY_CDE,
									SRC.EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
									SRC.SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
									SRC.TERM_RIDER_COVERAGE_AMT,
									SRC.TERM_RIDER_COVERAGE_QUALITY_CDE,
									SRC.DAY_OLD_IND,
									SRC.SOURCE_DAY_OLD_IND,
									SRC.ARREARS_INTEREST_CREDIT_AMT,
									SRC.ARREARS_INTEREST_PAID_AMT,
									SRC.MINIMUM_CASH_REQUIRED_AMT,
									SRC.MINIMUM_CASH_REQUIRED_QUALITY_CDE,
									SRC.NET_DUE_AMT,
									SRC.NET_DUE_QUALITY_CDE,
									SRC.GROSS_DEATH_BENEFIT_AMT,
									SRC.GROSS_DEATH_BENEFIT_QUALITY_CDE,
									SRC.CONTRACT_VAL_AMT,
									SRC.CONTRACT_VAL_QUALITY_CDE,
									SRC.MINIMUM_ACCOUNT_BALANCE_AMT,
									SRC.TOTAL_PUA_CASH_VAL_AMT,
									SRC.TOTAL_PUA_CASH_VAL_QUALITY_CDE,
									SRC.FUND_BALANCE_AMT,
									SRC.INT_LTC_BENEFIT_AMT,
									SRC.PAIDUP_AVAILABLE_AMT,
									SRC.PAIDUP_AVAILABLE_QUALITY_CDE,
									SRC.PAIDUP_FACE_AMT,
									SRC.PAIDUP_FACE_QUALITY_CDE,
									SRC.MGIR_RT,
									SRC.MGIR_RT_QUALITY_CDE,
									SRC.TOTAL_FIRST_YEAR_DEPOSIT_AMT,
									SRC.TOTAL_ROLLOVER_AMT,
									SRC.TOTAL_WITHDRAWAL_AMT,
									SRC.PRE_TEFRA_TAMRA_AMT,
									SRC.POST_TEFRA_TAMRA_AMT,
									SRC.AVAILABLE_WITHDRAWAL_FIXED_AMT,
									SRC.AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
									SRC.NEXT_PAYOUT_DT,
									SRC.END_PERIOD_CERTAIN_DT,
									SRC.LAST_PAYOUT_DT,
									SRC.TOTAL_GROSS_PAYOUT_AMT,
									SRC.TOTAL_NET_PAYOUT_AMT,
									SRC.YTD_GROSS_PAYOUT_AMT,
									SRC.YTD_NET_PAYOUT_AMT,
									SRC.YTD_WITHDRAWAL_AMT,
									SRC.BASIC_FREE_WITHDRAWAL_AMT,
									SRC.ADDITIONAL_FREE_WITHDRAWAL_AMT,
									SRC.YTD_NET_WITHDRAWAL_AMT,
									SRC.MVA_AMT,
									SRC.MINIMUM_SURRENDER_VAL_AMT,
									SRC.CONTRACT_GUARANTEED_INTEREST_RT,
									SRC.GMDB_AMT,
									SRC.GMDB_RATCHET_AMT,
									SRC.GMDB_ROLLUP_AMT,
									SRC.GMIB_RATCHET_AMT,
									SRC.GMIB_ROLLUP_AMT,
									SRC.GMIB_DT,
									SRC.NET_RISK_AMT,
									SRC.PYTD_WITHDRAWAL_AMT,
									SRC.NET_PURCHASE_PAYMENT_AMT,
									SRC.COVERED_CONTRACT_VAL_AMT,
									SRC.CYTD_CHARGE_AMT,
									SRC.RMD_AMT,
									SRC.FAIR_MARKET_VAL_AMT,
									SRC.GMAB_BASE_AMT,
									SRC.GMAB_NEXT_RESET_DT,
									SRC.GMAB_LAST_RESET_DT,
									SRC.TOTAL_COST_BASIS_AMT,
									SRC.PRE_TEFRA_AMT,
									SRC.POST_TEFRA_AMT,
									SRC.TOTAL_AVAILABLE_WITHDRAWAL_AMT,
									SRC.RMD_QUOTE_AMT,
									SRC.MGIR_REDETERMINATION_DT,
									SRC.MVA_ACCOUNT_VAL_AMT,
									SRC.GLWB_BENEFIT_BASE_AMT,
									SRC.GLWB_ROLLUP_RT,
									SRC.GLWB_BENEFIT_PAYMENT_AMT,
									SRC.GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
									SRC.GLWB_WITHDRAWAL_RT,
									SRC.GLWB_LIFETIME_GUARANTEE_RT,
									SRC.GLWB_WITHDRAWAL_RT_AGE_NR,
									SRC.GMSV_INTEREST_RT,
									SRC.GLWB_LAST_STEP_UP_DT,
									SRC.RMD_REMAINING_AMT,
									SRC.ACCUMULATED_POLICY_VAL_AMT,
									SRC.ACCUMULATED_POLICY_VAL_QUALITY_CDE,
									SRC.NET_ANNUAL_PREMIUM_AMT,
									SRC.NET_ANNUAL_PREMIUM_QUALITY_CDE,
									SRC.INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
									SRC.INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
									SRC.ADDITIONS_PURCHASE_AMT,
									SRC.ADDITIONS_PURCHASE_QUALITY_CDE,
									SRC.SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
									SRC.SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
									SRC.BASIC_AMT,
									SRC.BASIC_QUALITY_CDE,
									SRC.TOTAL_POLICY_CASH_VAL_AMT,
									SRC.TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
									SRC.RP_RN_RI_AMT,
									SRC.RP_RN_RI_QUALITY_CDE,
									SRC.RAFP_IRAFP_RESERVE_AMT,
									SRC.RAFP_IRAFP_RESERVE_QUALITY_CDE,
									SRC.DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
									SRC.DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
									SRC.DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
									SRC.DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
									SRC.ONE_YEAR_TERM_COST_AMT,
									SRC.ONE_YEAR_TERM_COST_QUALITY_CDE,
									SRC.YEAR_TERM_AGREEMENT_AMT,
									SRC.YEAR_TERM_AGREEMENT_QUALITY_CDE,
									SRC.GMIB_ACCOUNT_VAL_AMT,
									SRC.YEAR_END_VAL_AMT,
									SRC.ALIR_ANNUAL_PREMIUM_AMT,
									SRC.ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
									SRC.ALIR_CATCHUP_AVAILABLE_AMT,
									SRC.ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
									SRC.ALIR_CATCHUP_APPLIED_AMT,
									SRC.ALIR_CATCHUP_APPLIED_QUALITY_CDE,
									SRC.ALIR_CV_DIVIDEND_ADDITIONS_AMT,
									SRC.ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
									SRC.ALIR_CV_PAIDUP_ADDITIONS_AMT,
									SRC.ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
									SRC.ALIR_DIVIDEND_AMT,
									SRC.ALIR_DIVIDEND_QUALITY_CDE,
									SRC.ALIR_DIVIDEND_ADDITIONS_AMT,
									SRC.ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
									SRC.ALIR_DIVIDEND_AVAILABLE_AMT,
									SRC.ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
									SRC.ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
									SRC.ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
									SRC.ALIR_MODAL_PREMIUM_AMT,
									SRC.ALIR_MODAL_PREMIUM_QUALITY_CDE,
									SRC.ALIR_MONTHLY_PREMIUM_AMT,
									SRC.ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
									SRC.ALIR_POLICY_YEAR_NR,
									SRC.ALIR_PAIDUP_ADDITIONS_AMT,
									SRC.ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
									SRC.ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
									SRC.ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
									SRC.ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
									SRC.ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
									SRC.ALIR_UNSCHEDULED_PREMIUM_AMT,
									SRC.ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
									SRC.ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
									SRC.ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
									SRC.ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
									SRC.ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
									SRC.LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
									SRC.LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
									SRC.LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
									SRC.LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
									SRC.CV_PD_ALIR_LISR_AMT,
									SRC.CV_PD_ALIR_LISR_QUALITY_CDE,
									SRC.LISR_CV_DIVIDEND_ADDITIONS_AMT,
									SRC.LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
									SRC.LISR_CV_PAIDUP_ADDITIONS_AMT,
									SRC.LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
									SRC.LISR_DIVIDEND_AMT,
									SRC.LISR_DIVIDEND_QUALITY_CDE,
									SRC.LISR_DIVIDEND_ADDITIONS_AMT,
									SRC.LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
									SRC.LISR_DIVIDEND_AVAILABLE_AMT,
									SRC.LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
									SRC.LISR_PAIDUP_ADDITIONS_AMT,
									SRC.LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
									SRC.LISR_ANNUAL_PREMIUM_AMT,
									SRC.LISR_ANNUAL_PREMIUM_QUALITY_CDE,
									SRC.LISR_FACE_AMT,
									SRC.LISR_FACE_QUALITY_CDE,
									SRC.LISR_MONTHLY_PREMIUM_AMT,
									SRC.LISR_MONTHLY_PREMIUM_QUALITY_CDE,
									SRC.LISR_MODAL_PREMIUM_AMT,
									SRC.LISR_MODAL_PREMIUM_QUALITY_CDE,
									SRC.LISR_RECOMMENDED_PREMIUM_AMT,
									SRC.LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
									SRC.LISR_UNSCHEDULED_PREMIUM_AMT,
									SRC.LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
									SRC.LTC_PREMIUM_ADJUSTMENT_CDE,
									SRC.LTC_ACTIVE_CDE,
									SRC.LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
									SRC.LTC_DIVIDENDS_BENEFIT_POOL_AMT,
									SRC.LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
									SRC.LTC_RETURN_PREMIUM_AMT,
									SRC.LTC_RETURN_PREMIUM_QUALITY_CDE,
									SRC.LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
									SRC.LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
									SRC.LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
									SRC.LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
									SRC.LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
									SRC.LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
									SRC.LTC_CURRENT_MMB_AMT,
									SRC.LTC_CURRENT_MMB_QUALITY_CDE,
									SRC.LTC_BASE_BENEFIT_POOL_AMT,
									SRC.LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
									SRC.LTC_INITIAL_MMB_AMT,
									SRC.LTC_INITIAL_MMB_QUALITY_CDE,
									SRC.LTC_MMB_INCREASE_OPTION_IND,
									SRC.LTC_MMB_INCREASE_AMT,
									SRC.LTC_MMB_INCREASE_QUALITY_CDE,
									SRC.LTC_NEXT_MMB_INCREASE_DT,
									SRC.LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
									SRC.LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
									SRC.LTC_RESIDUAL_DEATH_BENEFIT_AMT,
									SRC.LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
									SRC.LTC_SELECTED_BENEFIT_PERIOD_NR,
									SRC.LTC_CLAIM_START_DT,
									SRC.PAIDUP_ADDITIONS_FACE_AMT,
									SRC.PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
									SRC.SL100_SL20P_POLICY_IND,
									SRC.PALIR_MAX_ANNUAL_PAYMENT_AMT,
									SRC.PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
									SRC.PALIR_PREMIUM_START_DT,
									SRC.PALIR_PREMIUM_END_DT,
									SRC.PALIR_YTD_PREMIUM_PAID_AMT,
									SRC.PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
									SRC.PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
									SRC.PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
									SRC.PALIR_ANNUAL_PAYMENT_CNT,
									SRC.BEGIN_DT,
									SRC.BEGIN_DTM,
									CURRENT_TIMESTAMP(6) AS ROW_PROCESS_DTM,
									SRC.CHECK_SUM,
									SRC.END_DT,
									SRC.END_DTM,
									SRC.RESTRICTED_ROW_IND,
									SRC.CURRENT_ROW_IND,
									SRC.LOGICAL_DELETE_IND,
									SRC.SOURCE_SYSTEM_ID,
									SRC.AUDIT_ID,
									SRC.UPDATE_AUDIT_ID,
									SRC.SOURCE_DELETE_IND,
									SRC.CREDITING_RT,
									SRC.CREDITING_RT_START_DT,
									SRC.CREDITING_RT_END_DT,
									SRC.CREDITING_REST_PERIOD_DESC,
									SRC.GROSS_NET_CDE,
									SRC.END_DT_BOOK_VAL_AMT,
									SRC.END_DT_MARKET_VAL_AMT,
									SRC.NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
									SRC.NEXT_BUSINESS_DAY_CREDITING_RT
from
edw_staging.aifrps_attr_agreement_values_pre_work SRC
LEFT JOIN {{target_schema}}.ATTR_AGREEMENT_VALUES TGT
ON      SRC.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID = TGT.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID
    AND TGT.CURRENT_ROW_IND = TRUE
	AND TGT.SOURCE_SYSTEM_ID IN ('72','266')
WHERE
        --handle when there isn't a current record in target but there are historical records and a delta coming through
(TGT.ROW_SID IS NULL AND SRC.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID IN (SELECT DISTINCT DIM_AGREEMENT_NATURAL_KEY_HASH_UUID FROM {{target_schema}}.ATTR_AGREEMENT_VALUES WHERE SOURCE_SYSTEM_ID IN ('72','266')) )
        --handle when there is a current target record and either the check_sum has changed or record is being logically deleted.
       OR
(TGT.ROW_SID IS NOT NULL
    --CHECKSUM CHANGED
    AND (TGT.CHECK_SUM <> SRC.CHECK_SUM)
 )
;

select analyze_statistics('edw_work.aifrps_attr_agreement_values');