/* Jira Details need to be mentioned */

INSERT INTO edw_tdsunset.attr_agreement_values_initial_aifrps --schema need to be changed
    (
                    DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
                    AGREEMENT_VAL_AS_OF_DT,
                    TOTAL_CONTRIBUTION_AMT,
                    TOTAL_CONTRIBUTION_QUALITY_CDE,
                    NET_DEATH_BENEFIT_AMT,
                    NET_DEATH_BENEFIT_QUALITY_CDE,
                    NET_DEATH_BENEFIT_DT,
                    NET_CASH_VAL_AMT,
                    NET_CASH_VAL_QUALITY_CDE,
                    TOTAL_ACCOUNT_VAL_AMT,
                    TOTAL_ACCOUNT_VAL_QUALITY_CDE,
                    GROSS_CASH_VAL_AMT,
                    GROSS_CASH_VAL_QUALITY_CDE,
                    SURRENDER_CHARGE_AMT,
                    SURRENDER_CHARGE_QUALITY_CDE,
                    GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
                    GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
                    DEFICIENCY_AMT,
                    DEFICIENCY_QUALITY_CDE,
                    LOW_DEATH_BENEFIT_AMT,
                    LOW_DEATH_BENEFIT_QUALITY_CDE,
                    EXCHANGE_1035_AMT,
                    EXCHANGE_1035_QUALITY_CDE,
                    EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
                    SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
                    TERM_RIDER_COVERAGE_AMT,
                    TERM_RIDER_COVERAGE_QUALITY_CDE,
                    DAY_OLD_IND,
                    SOURCE_DAY_OLD_IND,
                    ARREARS_INTEREST_CREDIT_AMT,
                    ARREARS_INTEREST_PAID_AMT,
                    MINIMUM_CASH_REQUIRED_AMT,
                    MINIMUM_CASH_REQUIRED_QUALITY_CDE,
                    NET_DUE_AMT,
                    NET_DUE_QUALITY_CDE,
                    GROSS_DEATH_BENEFIT_AMT,
                    GROSS_DEATH_BENEFIT_QUALITY_CDE,
                    CONTRACT_VAL_AMT,
                    CONTRACT_VAL_QUALITY_CDE,
                    MINIMUM_ACCOUNT_BALANCE_AMT,
                    TOTAL_PUA_CASH_VAL_AMT,
                    TOTAL_PUA_CASH_VAL_QUALITY_CDE,
                    FUND_BALANCE_AMT,
                    INT_LTC_BENEFIT_AMT,
                    PAIDUP_AVAILABLE_AMT,
                    PAIDUP_AVAILABLE_QUALITY_CDE,
                    PAIDUP_FACE_AMT,
                    PAIDUP_FACE_QUALITY_CDE,
                    MGIR_RT,
                    MGIR_RT_QUALITY_CDE,
                    TOTAL_FIRST_YEAR_DEPOSIT_AMT,
                    TOTAL_ROLLOVER_AMT,
                    TOTAL_WITHDRAWAL_AMT,
                    PRE_TEFRA_TAMRA_AMT,
                    POST_TEFRA_TAMRA_AMT,
                    AVAILABLE_WITHDRAWAL_FIXED_AMT,
                    AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
                    NEXT_PAYOUT_DT,
                    END_PERIOD_CERTAIN_DT,
                    LAST_PAYOUT_DT,
                    TOTAL_GROSS_PAYOUT_AMT,
                    TOTAL_NET_PAYOUT_AMT,
                    YTD_GROSS_PAYOUT_AMT,
                    YTD_NET_PAYOUT_AMT,
                    YTD_WITHDRAWAL_AMT,
                    BASIC_FREE_WITHDRAWAL_AMT,
                    ADDITIONAL_FREE_WITHDRAWAL_AMT,
                    YTD_NET_WITHDRAWAL_AMT,
                    MVA_AMT,
                    MINIMUM_SURRENDER_VAL_AMT,
                    CONTRACT_GUARANTEED_INTEREST_RT,
                    GMDB_AMT,
                    GMDB_RATCHET_AMT,
                    GMDB_ROLLUP_AMT,
                    GMIB_RATCHET_AMT,
                    GMIB_ROLLUP_AMT,
                    GMIB_DT,
                    NET_RISK_AMT,
                    PYTD_WITHDRAWAL_AMT,
                    NET_PURCHASE_PAYMENT_AMT,
                    COVERED_CONTRACT_VAL_AMT,
                    CYTD_CHARGE_AMT,
                    RMD_AMT,
                    FAIR_MARKET_VAL_AMT,
                    GMAB_BASE_AMT,
                    GMAB_NEXT_RESET_DT,
                    GMAB_LAST_RESET_DT,
                    TOTAL_COST_BASIS_AMT,
                    PRE_TEFRA_AMT,
                    POST_TEFRA_AMT,
                    TOTAL_AVAILABLE_WITHDRAWAL_AMT,
                    RMD_QUOTE_AMT,
                    MGIR_REDETERMINATION_DT,
                    MVA_ACCOUNT_VAL_AMT,
                    GLWB_BENEFIT_BASE_AMT,
                    GLWB_ROLLUP_RT,
                    GLWB_BENEFIT_PAYMENT_AMT,
                    GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
                    GLWB_WITHDRAWAL_RT,
                    GLWB_LIFETIME_GUARANTEE_RT,
                    GLWB_WITHDRAWAL_RT_AGE_NR,
                    GMSV_INTEREST_RT,
                    GLWB_LAST_STEP_UP_DT,
                    RMD_REMAINING_AMT,
                    ACCUMULATED_POLICY_VAL_AMT,
                    ACCUMULATED_POLICY_VAL_QUALITY_CDE,
                    NET_ANNUAL_PREMIUM_AMT,
                    NET_ANNUAL_PREMIUM_QUALITY_CDE,
                    INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
                    INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
                    ADDITIONS_PURCHASE_AMT,
                    ADDITIONS_PURCHASE_QUALITY_CDE,
                    SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
                    SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
                    BASIC_AMT,
                    BASIC_QUALITY_CDE,
                    TOTAL_POLICY_CASH_VAL_AMT,
                    TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
                    RP_RN_RI_AMT,
                    RP_RN_RI_QUALITY_CDE,
                    RAFP_IRAFP_RESERVE_AMT,
                    RAFP_IRAFP_RESERVE_QUALITY_CDE,
                    DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
                    DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
                    DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
                    DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
                    ONE_YEAR_TERM_COST_AMT,
                    ONE_YEAR_TERM_COST_QUALITY_CDE,
                    YEAR_TERM_AGREEMENT_AMT,
                    YEAR_TERM_AGREEMENT_QUALITY_CDE,
                    GMIB_ACCOUNT_VAL_AMT,
                    YEAR_END_VAL_AMT,
                    ALIR_ANNUAL_PREMIUM_AMT,
                    ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
                    ALIR_CATCHUP_AVAILABLE_AMT,
                    ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
                    ALIR_CATCHUP_APPLIED_AMT,
                    ALIR_CATCHUP_APPLIED_QUALITY_CDE,
                    ALIR_CV_DIVIDEND_ADDITIONS_AMT,
                    ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
                    ALIR_CV_PAIDUP_ADDITIONS_AMT,
                    ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
                    ALIR_DIVIDEND_AMT,
                    ALIR_DIVIDEND_QUALITY_CDE,
                    ALIR_DIVIDEND_ADDITIONS_AMT,
                    ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
                    ALIR_DIVIDEND_AVAILABLE_AMT,
                    ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
                    ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
                    ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
                    ALIR_MODAL_PREMIUM_AMT,
                    ALIR_MODAL_PREMIUM_QUALITY_CDE,
                    ALIR_MONTHLY_PREMIUM_AMT,
                    ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
                    ALIR_POLICY_YEAR_NR,
                    ALIR_PAIDUP_ADDITIONS_AMT,
                    ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
                    ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
                    ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
                    ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
                    ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
                    ALIR_UNSCHEDULED_PREMIUM_AMT,
                    ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
                    ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
                    ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
                    ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
                    ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
                    LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
                    LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
                    LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
                    LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
                    CV_PD_ALIR_LISR_AMT,
                    CV_PD_ALIR_LISR_QUALITY_CDE,
                    LISR_CV_DIVIDEND_ADDITIONS_AMT,
                    LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
                    LISR_CV_PAIDUP_ADDITIONS_AMT,
                    LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
                    LISR_DIVIDEND_AMT,
                    LISR_DIVIDEND_QUALITY_CDE,
                    LISR_DIVIDEND_ADDITIONS_AMT,
                    LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
                    LISR_DIVIDEND_AVAILABLE_AMT,
                    LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
                    LISR_PAIDUP_ADDITIONS_AMT,
                    LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
                    LISR_ANNUAL_PREMIUM_AMT,
                    LISR_ANNUAL_PREMIUM_QUALITY_CDE,
                    LISR_FACE_AMT,
                    LISR_FACE_QUALITY_CDE,
                    LISR_MONTHLY_PREMIUM_AMT,
                    LISR_MONTHLY_PREMIUM_QUALITY_CDE,
                    LISR_MODAL_PREMIUM_AMT,
                    LISR_MODAL_PREMIUM_QUALITY_CDE,
                    LISR_RECOMMENDED_PREMIUM_AMT,
                    LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
                    LISR_UNSCHEDULED_PREMIUM_AMT,
                    LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
                    LTC_PREMIUM_ADJUSTMENT_CDE,
                    LTC_ACTIVE_CDE,
                    LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
                    LTC_DIVIDENDS_BENEFIT_POOL_AMT,
                    LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
                    LTC_RETURN_PREMIUM_AMT,
                    LTC_RETURN_PREMIUM_QUALITY_CDE,
                    LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
                    LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
                    LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
                    LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
                    LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
                    LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
                    LTC_CURRENT_MMB_AMT,
                    LTC_CURRENT_MMB_QUALITY_CDE,
                    LTC_BASE_BENEFIT_POOL_AMT,
                    LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
                    LTC_INITIAL_MMB_AMT,
                    LTC_INITIAL_MMB_QUALITY_CDE,
                    LTC_MMB_INCREASE_OPTION_IND,
                    LTC_MMB_INCREASE_AMT,
                    LTC_MMB_INCREASE_QUALITY_CDE,
                    LTC_NEXT_MMB_INCREASE_DT,
                    LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
                    LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
                    LTC_RESIDUAL_DEATH_BENEFIT_AMT,
                    LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
                    LTC_SELECTED_BENEFIT_PERIOD_NR,
                    LTC_CLAIM_START_DT,
                    PAIDUP_ADDITIONS_FACE_AMT,
                    PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
                    SL100_SL20P_POLICY_IND,
                    PALIR_MAX_ANNUAL_PAYMENT_AMT,
                    PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
                    PALIR_PREMIUM_START_DT,
                    PALIR_PREMIUM_END_DT,
                    PALIR_YTD_PREMIUM_PAID_AMT,
                    PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
                    PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
                    PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
                    PALIR_ANNUAL_PAYMENT_CNT,
                    BEGIN_DT,
                    BEGIN_DTM,
                    ROW_PROCESS_DTM,
                    CHECK_SUM,
                    END_DT,
                    END_DTM,
                    RESTRICTED_ROW_IND,
                    CURRENT_ROW_IND,
                    LOGICAL_DELETE_IND,
                    SOURCE_SYSTEM_ID,
                    AUDIT_ID,
                    UPDATE_AUDIT_ID,
                    SOURCE_DELETE_IND,
					CREDITING_RT,
					CREDITING_RT_START_DT,
					CREDITING_RT_END_DT,
					CREDITING_REST_PERIOD_DESC,
					GROSS_NET_CDE,
					END_DT_BOOK_VAL_AMT,
					END_DT_MARKET_VAL_AMT,
					NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
					NEXT_BUSINESS_DAY_CREDITING_RT
)
SELECT 
STG.DIM_AGREEMENT_NATURAL_KEY_HASH_UUID,
--STG.VALU_AGREEMENT_NO,
STG.AGREEMENT_VAL_AS_OF_DT,
STG.TOTAL_CONTRIBUTION_AMT,
STG.TOTAL_CONTRIBUTION_QUALITY_CDE,
STG.NET_DEATH_BENEFIT_AMT,
STG.NET_DEATH_BENEFIT_QUALITY_CDE,
STG.NET_DEATH_BENEFIT_DT,
STG.NET_CASH_VAL_AMT,
STG.NET_CASH_VAL_QUALITY_CDE,
STG.TOTAL_ACCOUNT_VAL_AMT,
STG.TOTAL_ACCOUNT_VAL_QUALITY_CDE,
STG.GROSS_CASH_VAL_AMT,
STG.GROSS_CASH_VAL_QUALITY_CDE,
STG.SURRENDER_CHARGE_AMT,
STG.SURRENDER_CHARGE_QUALITY_CDE,
STG.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
STG.GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
STG.DEFICIENCY_AMT,
STG.DEFICIENCY_QUALITY_CDE,
STG.LOW_DEATH_BENEFIT_AMT,
STG.LOW_DEATH_BENEFIT_QUALITY_CDE,
STG.EXCHANGE_1035_AMT,
STG.EXCHANGE_1035_QUALITY_CDE,
STG.EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
STG.SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
STG.TERM_RIDER_COVERAGE_AMT,
STG.TERM_RIDER_COVERAGE_QUALITY_CDE,
STG.DAY_OLD_IND,
STG.SOURCE_DAY_OLD_IND,
STG.ARREARS_INTEREST_CREDIT_AMT,
STG.ARREARS_INTEREST_PAID_AMT,
STG.MINIMUM_CASH_REQUIRED_AMT,
STG.MINIMUM_CASH_REQUIRED_QUALITY_CDE,
STG.NET_DUE_AMT,
STG.NET_DUE_QUALITY_CDE,
STG.GROSS_DEATH_BENEFIT_AMT,
STG.GROSS_DEATH_BENEFIT_QUALITY_CDE,
STG.CONTRACT_VAL_AMT,
STG.CONTRACT_VAL_QUALITY_CDE,
STG.MINIMUM_ACCOUNT_BALANCE_AMT,
STG.TOTAL_PUA_CASH_VAL_AMT,
STG.TOTAL_PUA_CASH_VAL_QUALITY_CDE,
STG.FUND_BALANCE_AMT,
STG.INT_LTC_BENEFIT_AMT,
STG.PAIDUP_AVAILABLE_AMT,
STG.PAIDUP_AVAILABLE_QUALITY_CDE,
STG.PAIDUP_FACE_AMT,
STG.PAIDUP_FACE_QUALITY_CDE,
STG.MGIR_RT,
STG.MGIR_RT_QUALITY_CDE,
STG.TOTAL_FIRST_YEAR_DEPOSIT_AMT,
STG.TOTAL_ROLLOVER_AMT,
STG.TOTAL_WITHDRAWAL_AMT,
STG.PRE_TEFRA_TAMRA_AMT,
STG.POST_TEFRA_TAMRA_AMT,
STG.AVAILABLE_WITHDRAWAL_FIXED_AMT,
STG.AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
STG.NEXT_PAYOUT_DT,
STG.END_PERIOD_CERTAIN_DT,
STG.LAST_PAYOUT_DT,
STG.TOTAL_GROSS_PAYOUT_AMT,
STG.TOTAL_NET_PAYOUT_AMT,
STG.YTD_GROSS_PAYOUT_AMT,
STG.YTD_NET_PAYOUT_AMT,
STG.YTD_WITHDRAWAL_AMT,
STG.BASIC_FREE_WITHDRAWAL_AMT,
STG.ADDITIONAL_FREE_WITHDRAWAL_AMT,
STG.YTD_NET_WITHDRAWAL_AMT,
STG.MVA_AMT,
STG.MINIMUM_SURRENDER_VAL_AMT,
STG.CONTRACT_GUARANTEED_INTEREST_RT,
STG.GMDB_AMT,
STG.GMDB_RATCHET_AMT,
STG.GMDB_ROLLUP_AMT,
STG.GMIB_RATCHET_AMT,
STG.GMIB_ROLLUP_AMT,
STG.GMIB_DT,
STG.NET_RISK_AMT,
STG.PYTD_WITHDRAWAL_AMT,
STG.NET_PURCHASE_PAYMENT_AMT,
STG.COVERED_CONTRACT_VAL_AMT,
STG.CYTD_CHARGE_AMT,
STG.RMD_AMT,
STG.FAIR_MARKET_VAL_AMT,
STG.GMAB_BASE_AMT,
STG.GMAB_NEXT_RESET_DT,
STG.GMAB_LAST_RESET_DT,
STG.TOTAL_COST_BASIS_AMT,
STG.PRE_TEFRA_AMT,
STG.POST_TEFRA_AMT,
STG.TOTAL_AVAILABLE_WITHDRAWAL_AMT,
STG.RMD_QUOTE_AMT,
STG.MGIR_REDETERMINATION_DT,
STG.MVA_ACCOUNT_VAL_AMT,
STG.GLWB_BENEFIT_BASE_AMT,
STG.GLWB_ROLLUP_RT,
STG.GLWB_BENEFIT_PAYMENT_AMT,
STG.GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
STG.GLWB_WITHDRAWAL_RT,
STG.GLWB_LIFETIME_GUARANTEE_RT,
STG.GLWB_WITHDRAWAL_RT_AGE_NR,
STG.GMSV_INTEREST_RT,
STG.GLWB_LAST_STEP_UP_DT,
STG.RMD_REMAINING_AMT,
STG.ACCUMULATED_POLICY_VAL_AMT,
STG.ACCUMULATED_POLICY_VAL_QUALITY_CDE,
STG.NET_ANNUAL_PREMIUM_AMT,
STG.NET_ANNUAL_PREMIUM_QUALITY_CDE,
STG.INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
STG.INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
STG.ADDITIONS_PURCHASE_AMT,
STG.ADDITIONS_PURCHASE_QUALITY_CDE,
STG.SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
STG.SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
STG.BASIC_AMT,
STG.BASIC_QUALITY_CDE,
STG.TOTAL_POLICY_CASH_VAL_AMT,
STG.TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
STG.RP_RN_RI_AMT,
STG.RP_RN_RI_QUALITY_CDE,
STG.RAFP_IRAFP_RESERVE_AMT,
STG.RAFP_IRAFP_RESERVE_QUALITY_CDE,
STG.DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
STG.DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
STG.DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
STG.DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
STG.ONE_YEAR_TERM_COST_AMT,
STG.ONE_YEAR_TERM_COST_QUALITY_CDE,
STG.YEAR_TERM_AGREEMENT_AMT,
STG.YEAR_TERM_AGREEMENT_QUALITY_CDE,
STG.GMIB_ACCOUNT_VAL_AMT,
STG.YEAR_END_VAL_AMT,
STG.ALIR_ANNUAL_PREMIUM_AMT,
STG.ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
STG.ALIR_CATCHUP_AVAILABLE_AMT,
STG.ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
STG.ALIR_CATCHUP_APPLIED_AMT,
STG.ALIR_CATCHUP_APPLIED_QUALITY_CDE,
STG.ALIR_CV_DIVIDEND_ADDITIONS_AMT,
STG.ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
STG.ALIR_CV_PAIDUP_ADDITIONS_AMT,
STG.ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.ALIR_DIVIDEND_AMT,
STG.ALIR_DIVIDEND_QUALITY_CDE,
STG.ALIR_DIVIDEND_ADDITIONS_AMT,
STG.ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
STG.ALIR_DIVIDEND_AVAILABLE_AMT,
STG.ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
STG.ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
STG.ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
STG.ALIR_MODAL_PREMIUM_AMT,
STG.ALIR_MODAL_PREMIUM_QUALITY_CDE,
STG.ALIR_MONTHLY_PREMIUM_AMT,
STG.ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
STG.ALIR_POLICY_YEAR_NR,
STG.ALIR_PAIDUP_ADDITIONS_AMT,
STG.ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
STG.ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
STG.ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
STG.ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
STG.ALIR_UNSCHEDULED_PREMIUM_AMT,
STG.ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
STG.ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
STG.ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
STG.ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
STG.ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
STG.LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
STG.LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
STG.LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
STG.LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
STG.CV_PD_ALIR_LISR_AMT,
STG.CV_PD_ALIR_LISR_QUALITY_CDE,
STG.LISR_CV_DIVIDEND_ADDITIONS_AMT,
STG.LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
STG.LISR_CV_PAIDUP_ADDITIONS_AMT,
STG.LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.LISR_DIVIDEND_AMT,
STG.LISR_DIVIDEND_QUALITY_CDE,
STG.LISR_DIVIDEND_ADDITIONS_AMT,
STG.LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
STG.LISR_DIVIDEND_AVAILABLE_AMT,
STG.LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
STG.LISR_PAIDUP_ADDITIONS_AMT,
STG.LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.LISR_ANNUAL_PREMIUM_AMT,
STG.LISR_ANNUAL_PREMIUM_QUALITY_CDE,
STG.LISR_FACE_AMT,
STG.LISR_FACE_QUALITY_CDE,
STG.LISR_MONTHLY_PREMIUM_AMT,
STG.LISR_MONTHLY_PREMIUM_QUALITY_CDE,
STG.LISR_MODAL_PREMIUM_AMT,
STG.LISR_MODAL_PREMIUM_QUALITY_CDE,
STG.LISR_RECOMMENDED_PREMIUM_AMT,
STG.LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
STG.LISR_UNSCHEDULED_PREMIUM_AMT,
STG.LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
STG.LTC_PREMIUM_ADJUSTMENT_CDE,
STG.LTC_ACTIVE_CDE,
STG.LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
STG.LTC_DIVIDENDS_BENEFIT_POOL_AMT,
STG.LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
STG.LTC_RETURN_PREMIUM_AMT,
STG.LTC_RETURN_PREMIUM_QUALITY_CDE,
STG.LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
STG.LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
STG.LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
STG.LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
STG.LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
STG.LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
STG.LTC_CURRENT_MMB_AMT,
STG.LTC_CURRENT_MMB_QUALITY_CDE,
STG.LTC_BASE_BENEFIT_POOL_AMT,
STG.LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
STG.LTC_INITIAL_MMB_AMT,
STG.LTC_INITIAL_MMB_QUALITY_CDE,
STG.LTC_MMB_INCREASE_OPTION_IND,
STG.LTC_MMB_INCREASE_AMT,
STG.LTC_MMB_INCREASE_QUALITY_CDE,
STG.LTC_NEXT_MMB_INCREASE_DT,
STG.LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
STG.LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
STG.LTC_RESIDUAL_DEATH_BENEFIT_AMT,
STG.LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
STG.LTC_SELECTED_BENEFIT_PERIOD_NR,
STG.LTC_CLAIM_START_DT,
STG.PAIDUP_ADDITIONS_FACE_AMT,
STG.PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
STG.SL100_SL20P_POLICY_IND,
STG.PALIR_MAX_ANNUAL_PAYMENT_AMT,
STG.PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
STG.PALIR_PREMIUM_START_DT,
STG.PALIR_PREMIUM_END_DT,
STG.PALIR_YTD_PREMIUM_PAID_AMT,
STG.PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
STG.PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
STG.PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
STG.PALIR_ANNUAL_PAYMENT_CNT,
STG.BEGIN_DT,
STG.BEGIN_DTM,
STG.ROW_PROCESS_DTM,
UUID_GEN
(
    			        STG.SOURCE_DELETE_IND,
                        STG.AGREEMENT_VAL_AS_OF_DT,
    					STG.TOTAL_CONTRIBUTION_AMT,
						STG.NET_CASH_VAL_AMT,
						STG.TOTAL_ACCOUNT_VAL_AMT,
						STG.GROSS_CASH_VAL_AMT,
						STG.GROSS_DEATH_BENEFIT_AMT,
						STG.BASIC_FREE_WITHDRAWAL_AMT,
						STG.TOTAL_AVAILABLE_WITHDRAWAL_AMT,
						STG.YTD_GROSS_PAYOUT_AMT,
						STG.YTD_NET_PAYOUT_AMT,
						STG.YTD_WITHDRAWAL_AMT
)::UUID AS CHECK_SUM,
STG.END_DT,
STG.END_DTM,
STG.RESTRICTED_ROW_IND,
STG.CURRENT_ROW_IND::BOOLEAN,
STG.LOGICAL_DELETE_IND,
STG.SOURCE_SYSTEM_ID,
STG.AUDIT_ID,
STG.UPDATE_AUDIT_ID,
STG.SOURCE_DELETE_IND,
STG.CREDITING_RT,
STG.CREDITING_RT_START_DT,
STG.CREDITING_RT_END_DT,
STG.CREDITING_REST_PERIOD_DESC,
STG.GROSS_NET_CDE,
STG.END_DT_BOOK_VAL_AMT,
STG.END_DT_MARKET_VAL_AMT,
STG.NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
STG.NEXT_BUSINESS_DAY_CREDITING_RT
--STG.PROCESS_IND
FROM
(SELECT DISTINCT
UUID_GEN(
        CLEAN_STRING('RPS'),
        CLEAN_STRING('IPA'),
        UDF_ISNUM_LPAD(AGMT_VAL.HLDG_KEY_PFX, 20, '0', TRUE),
        LPAD(AGMT_VAL.HLDG_KEY::VARCHAR, 20, '0'),
        UDF_ISNUM_LPAD(AGMT_VAL.HLDG_KEY_SFX, 20, '0', TRUE)
        )::UUID AS dim_agreement_natural_key_hash_uuid,
--LPAD(AGMT_VAL.HLDG_KEY::VARCHAR, 20, '0') AS VALU_AGREEMENT_NO,
--AGMT_VAL.AGMT_ID                             AS AGMT_ID,
AGMT_VAL.AGMT_VAL_AS_OF_DT                     AS AGREEMENT_VAL_AS_OF_DT,
AGMT_VAL.TOT_CNTRB_AMT						   AS TOTAL_CONTRIBUTION_AMT,
AGMT_VAL.TOT_CNTRB_QLTY_CD                     AS TOTAL_CONTRIBUTION_QUALITY_CDE,
AGMT_VAL.NET_DTH_BEN_AMT					   AS NET_DEATH_BENEFIT_AMT,
AGMT_VAL.NET_DTH_BEN_QLTY_CD                   AS NET_DEATH_BENEFIT_QUALITY_CDE,
AGMT_VAL.NET_DTH_BEN_DT                        AS NET_DEATH_BENEFIT_DT,
AGMT_VAL.NET_CSH_VAL_AMT				       AS NET_CASH_VAL_AMT,
AGMT_VAL.NET_CSH_VAL_QLTY_CD                   AS NET_CASH_VAL_QUALITY_CDE,
AGMT_VAL.TOT_ACCT_VAL_AMT					   AS TOTAL_ACCOUNT_VAL_AMT,
AGMT_VAL.TOT_ACCT_VAL_QLTY_CD                  AS TOTAL_ACCOUNT_VAL_QUALITY_CDE,
AGMT_VAL.GRS_CASH_VAL_AMT					   AS GROSS_CASH_VAL_AMT,
AGMT_VAL.GRS_CASH_VAL_QLTY_CD                  AS GROSS_CASH_VAL_QUALITY_CDE,
AGMT_VAL.SURR_CHG_AMT						   AS SURRENDER_CHARGE_AMT,
AGMT_VAL.SURR_CHG_QLTY_CD                      AS SURRENDER_CHARGE_QUALITY_CDE,
AGMT_VAL.GDB_ACCT_VAL_AMT			           AS GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_AMT,
AGMT_VAL.GDB_ACCT_VAL_QLTY_CD                  AS GUARANTEED_DEATH_BENEFIT_ACCOUNT_VAL_QUALITY_CDE,
AGMT_VAL.DFCT_AMT							   AS DEFICIENCY_AMT,
AGMT_VAL.DFCT_AMT_QLTY_CD                      AS DEFICIENCY_QUALITY_CDE,
AGMT_VAL.LOW_DTH_BEN_AMT					   AS LOW_DEATH_BENEFIT_AMT,
AGMT_VAL.LOW_DTH_BEN_QLTY_CD                   AS LOW_DEATH_BENEFIT_QUALITY_CDE,
AGMT_VAL.XCHG_1035_AMT					       AS EXCHANGE_1035_AMT,
AGMT_VAL.XCHG_1035_QLTY_CD                     AS EXCHANGE_1035_QUALITY_CDE,
AGMT_VAL.XCHG_1035_PREM_APPL_VER_CD            AS EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
AGMT_VAL.SRC_XCHG_1035_PREM_APPL_VER_CD        AS SOURCE_EXCHANGE_1035_PREMIUM_APPLIED_VERIFICATION_CDE,
AGMT_VAL.TRMN_AMT							   AS TERM_RIDER_COVERAGE_AMT,
AGMT_VAL.TRMN_AMT_QLTY_CD                      AS TERM_RIDER_COVERAGE_QUALITY_CDE,
--AGMT_VAL.DY_OLD_IND                          AS DAY_OLD_IND,
CLEAN_STRING(AGMT_VAL.DY_OLD_IND)::BOOLEAN     AS DAY_OLD_IND,
AGMT_VAL.SRC_DY_OLD_IND                        AS SOURCE_DAY_OLD_IND,
AGMT_VAL.ARREARS_INT_CRDT_AMT                  AS ARREARS_INTEREST_CREDIT_AMT,
AGMT_VAL.ARREARS_INT_PD_AMT                    AS ARREARS_INTEREST_PAID_AMT,
AGMT_VAL.MIN_CSH_REQ_AMT				       AS MINIMUM_CASH_REQUIRED_AMT,
AGMT_VAL.MIN_CSH_REQ_QLTY_CD                   AS MINIMUM_CASH_REQUIRED_QUALITY_CDE,
AGMT_VAL.NET_DUE_AMT 						   AS NET_DUE_AMT,
AGMT_VAL.NET_DUE_QLTY_CD                       AS NET_DUE_QUALITY_CDE,
AGMT_VAL.GRS_DTH_BEN_AMT 					   AS GROSS_DEATH_BENEFIT_AMT,
AGMT_VAL.GRS_DTH_BEN_AMT_QLTY_CD               AS GROSS_DEATH_BENEFIT_QUALITY_CDE,
AGMT_VAL.CTRT_VAL_AMT 					       AS CONTRACT_VAL_AMT,
AGMT_VAL.CTRT_VAL_AMT_QLTY_CD                  AS CONTRACT_VAL_QUALITY_CDE,
AGMT_VAL.MIN_ACCT_BAL_AMT                      AS MINIMUM_ACCOUNT_BALANCE_AMT,
AGMT_VAL.CV_PDUP_ADDL_AMT					   AS TOTAL_PUA_CASH_VAL_AMT,
AGMT_VAL.CV_PDUP_ADDL_QLTY_CD                  AS TOTAL_PUA_CASH_VAL_QUALITY_CDE,
AGMT_VAL.FND_BAL_AMT                           AS FUND_BALANCE_AMT,
AGMT_VAL.INT_LTC_BEN_AMT                       AS INT_LTC_BENEFIT_AMT,
AGMT_VAL.PDUP_AVAL_AMT						   AS PAIDUP_AVAILABLE_AMT,
AGMT_VAL.PDUP_AVAL_QLTY_CD                     AS PAIDUP_AVAILABLE_QUALITY_CDE,
AGMT_VAL.PDUP_FACE_AMT						   AS PAIDUP_FACE_AMT,
AGMT_VAL.PDUP_FACE_QLTY_CD                     AS PAIDUP_FACE_QUALITY_CDE,
AGMT_VAL.MIN_GTEE_INT_RT					   AS MGIR_RT,
AGMT_VAL.MIN_GTEE_INT_RT_QLTY_CD               AS MGIR_RT_QUALITY_CDE,
AGMT_VAL.TOT_FYR_DPST_AMT                      AS TOTAL_FIRST_YEAR_DEPOSIT_AMT,
AGMT_VAL.TOT_ROVR_AMT                          AS TOTAL_ROLLOVER_AMT,
AGMT_VAL.TOT_WDRWL_AMT                         AS TOTAL_WITHDRAWAL_AMT,
AGMT_VAL.PRE_TEFRA_TAMRA_AMT                   AS PRE_TEFRA_TAMRA_AMT,
AGMT_VAL.POST_TEFRA_TAMRA_AMT                  AS POST_TEFRA_TAMRA_AMT,
AGMT_VAL.AVL_WDRWL_FXD_AMT                     AS AVAILABLE_WITHDRAWAL_FIXED_AMT,
AGMT_VAL.AVL_WDRWL_VAR_AMT                     AS AVAILABLE_WITHDRAWAL_VARIABLE_AMT,
AGMT_VAL.NXT_PYOT_DT                           AS NEXT_PAYOUT_DT,
AGMT_VAL.LST_CRTN_PYOT_DT                      AS END_PERIOD_CERTAIN_DT,
AGMT_VAL.LST_PYOT_DT                           AS LAST_PAYOUT_DT,
AGMT_VAL.TOT_GRS_PYOT_AMT                      AS TOTAL_GROSS_PAYOUT_AMT,
AGMT_VAL.TOT_NET_PYOT_AMT                      AS TOTAL_NET_PAYOUT_AMT,
AGMT_VAL.YTD_GRS_PYOT_AMT                      AS YTD_GROSS_PAYOUT_AMT,
AGMT_VAL.YTD_NET_PYOT_AMT                      AS YTD_NET_PAYOUT_AMT,
AGMT_VAL.YTD_WDRWL_AMT                         AS YTD_WITHDRAWAL_AMT,
AGMT_VAL.BSIC_FREE_WDRWL_AMT                   AS BASIC_FREE_WITHDRAWAL_AMT,
AGMT_VAL.ADDL_FREE_WDRWL_AMT                   AS ADDITIONAL_FREE_WITHDRAWAL_AMT,
AGMT_VAL.CUR_YR_WDRWL_AMT                      AS YTD_NET_WITHDRAWAL_AMT,
AGMT_VAL.MKT_VAL_ADJ_AMT                       AS MVA_AMT,
AGMT_VAL.MIN_SURR_VAL_AMT                      AS MINIMUM_SURRENDER_VAL_AMT,
AGMT_VAL.CONTR_GTEE_INT_RT                     AS CONTRACT_GUARANTEED_INTEREST_RT,
AGMT_VAL.GTEE_MIN_DTH_BEN_AMT                  AS GMDB_AMT,
AGMT_VAL.GTEE_MIN_DTH_BEN_RTHET_AMT            AS GMDB_RATCHET_AMT,
AGMT_VAL.GTEE_MIN_DTH_BEN_RLUP_AMT             AS GMDB_ROLLUP_AMT,
AGMT_VAL.GTEE_MIN_INC_BEN_RTHET_AMT            AS GMIB_RATCHET_AMT,
AGMT_VAL.GTEE_MIN_INC_BEN_RLUP_AMT             AS GMIB_ROLLUP_AMT,
AGMT_VAL.GTEE_MIN_INC_BEN_DT                   AS GMIB_DT,
AGMT_VAL.NET_RISK_AMT                          AS NET_RISK_AMT,
AGMT_VAL.PYTD_WDRWL_AMT                        AS PYTD_WITHDRAWAL_AMT,
AGMT_VAL.NET_PRCH_PAY_AMT                      AS NET_PURCHASE_PAYMENT_AMT,
AGMT_VAL.CVRD_CNTRCT_VAL_AMT                   AS COVERED_CONTRACT_VAL_AMT,
AGMT_VAL.CYTD_CHRG_AMT                         AS CYTD_CHARGE_AMT,
AGMT_VAL.REQD_MIN_DISTR_AMT                    AS RMD_AMT,
AGMT_VAL.FAIR_MKT_VAL_AMT                      AS FAIR_MARKET_VAL_AMT,
AGMT_VAL.GTEE_MIN_ACCUM_BEN_AMT                AS GMAB_BASE_AMT,
AGMT_VAL.GMAB_RESET_NXT_DT                     AS GMAB_NEXT_RESET_DT,
AGMT_VAL.GMAB_RESET_LST_DT                     AS GMAB_LAST_RESET_DT,
AGMT_VAL.TOT_COST_BASIS_AMT                    AS TOTAL_COST_BASIS_AMT,
AGMT_VAL.PRE_TEFRA_AMT                         AS PRE_TEFRA_AMT,
AGMT_VAL.PORT_TEFRA_AMT                        AS POST_TEFRA_AMT,
AGMT_VAL.TOT_AVL_WDRWL_AMT                     AS TOTAL_AVAILABLE_WITHDRAWAL_AMT,
AGMT_VAL.REQRD_MIN_DISTR_QUOTE_AMT             AS RMD_QUOTE_AMT,
AGMT_VAL.MGIR_REDETERM_DT                      AS MGIR_REDETERMINATION_DT,
AGMT_VAL.MVA_ACCT_VAL_AMT                      AS MVA_ACCOUNT_VAL_AMT,
AGMT_VAL.GLWB_BASE_AMT                         AS GLWB_BENEFIT_BASE_AMT,
AGMT_VAL.GLWB_ROLLUP_RT                        AS GLWB_ROLLUP_RT,
AGMT_VAL.GLWB_PYMT_AMT                         AS GLWB_BENEFIT_PAYMENT_AMT,
AGMT_VAL.GLWB_REMAINING_BEN_AMT                AS GLWB_REMAINING_BENEFIT_PAYMENT_AMT,
AGMT_VAL.GLWB_WDRWL_RT                         AS GLWB_WITHDRAWAL_RT,
AGMT_VAL.GLWB_LIFE_GTEE_RT                     AS GLWB_LIFETIME_GUARANTEE_RT,
AGMT_VAL.GLWB_WDRWL_RT_AGE                     AS GLWB_WITHDRAWAL_RT_AGE_NR,
AGMT_VAL.GMSV_INT_RT                           AS GMSV_INTEREST_RT,
AGMT_VAL.GLWB_LAST_STEP_UP_DT                  AS GLWB_LAST_STEP_UP_DT,
AGMT_VAL.REQRD_MIN_DISTR_REMAINING_AMT         AS RMD_REMAINING_AMT,
AGMT_VAL.ACCUM_POLICY_VAL_AMT   		       AS ACCUMULATED_POLICY_VAL_AMT,
AGMT_VAL.ACCUM_POLICY_VAL_QLTY_CD              AS ACCUMULATED_POLICY_VAL_QUALITY_CDE,
AGMT_VAL.NET_ANNL_PREM_AMT					   AS NET_ANNUAL_PREMIUM_AMT,
AGMT_VAL.NET_ANNL_PREM_QLTY_CD                 AS NET_ANNUAL_PREMIUM_QUALITY_CDE,
AGMT_VAL.INT_ON_DVD_ACCUM_AMT		           AS INTEREST_ON_DIVIDEND_ACCUMULATION_AMT,
AGMT_VAL.INT_ON_DVD_ACCUM_QLTY_CD              AS INTEREST_ON_DIVIDEND_ACCUMULATION_QUALITY_CDE,
AGMT_VAL.ADDNS_PURCH_AMT					   AS ADDITIONS_PURCHASE_AMT,
AGMT_VAL.ADDNS_PURCH_QLTY_CD                   AS ADDITIONS_PURCHASE_QUALITY_CDE,
AGMT_VAL.SUP_TERM_COST_PD_CURR_AMT			   AS SUPPLEMENTAL_TERM_COST_PAID_CURRENT_AMT,
AGMT_VAL.SUP_TERM_COST_PD_QLTY_CD              AS SUPPLEMENTAL_TERM_COST_PAID_CURRENT_QUALITY_CDE,
AGMT_VAL.BASIC_AMT							   AS BASIC_AMT,
AGMT_VAL.BASIC_QLTY_CD                         AS BASIC_QUALITY_CDE,
AGMT_VAL.TOT_POL_CSH_VAL_AMT				   AS TOTAL_POLICY_CASH_VAL_AMT,
AGMT_VAL.TOT_POL_CSH_VAL_QLTY_CD               AS TOTAL_POLICY_CASH_VAL_QUALITY_CDE,
AGMT_VAL.RP_RN_RI_AMT					       AS RP_RN_RI_AMT,
AGMT_VAL.RP_RN_RI_QLTY_CD                      AS RP_RN_RI_QUALITY_CDE,
AGMT_VAL.RAFP_IRAFP_RES_AMT					   AS RAFP_IRAFP_RESERVE_AMT,
AGMT_VAL.RAFP_IRAFP_RES_QLTY_CD                AS RAFP_IRAFP_RESERVE_QUALITY_CDE,
AGMT_VAL.DEV_OR_SB_AMT					       AS DEVIATION_OR_SUPPLEMENTAL_BENEFIT_AMT,
AGMT_VAL.DEV_OR_SB_QLTY_CD                     AS DEVIATION_OR_SUPPLEMENTAL_BENEFIT_QUALITY_CDE,
AGMT_VAL.DFRD_PDUP_ADD_DIVD_AMT			       AS DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_AMT,
AGMT_VAL.DFRD_PDUP_ADD_DIVD_QLTY_CD            AS DEFERRED_PAIDUP_ADDITIONS_DIVIDEND_QUALITY_CDE,
AGMT_VAL.ONE_YR_TRM_COST_AMT				   AS ONE_YEAR_TERM_COST_AMT,
AGMT_VAL.ONE_YR_TRM_COST_QLTY_CD               AS ONE_YEAR_TERM_COST_QUALITY_CDE,
AGMT_VAL.YR_TRM_AGMT_AMT					   AS YEAR_TERM_AGREEMENT_AMT,
AGMT_VAL.YR_TRM_AGMT_AMT_QLTY_CD               AS YEAR_TERM_AGREEMENT_QUALITY_CDE,
AGMT_VAL.GMIB_ACCT_VAL_AMT                     AS GMIB_ACCOUNT_VAL_AMT,
AGMT_VAL.YEAR_END_VAL_AMT                      AS YEAR_END_VAL_AMT,
NULL                                           AS ALIR_ANNUAL_PREMIUM_AMT,
NULL                                           AS ALIR_ANNUAL_PREMIUM_QUALITY_CDE,
NULL                                           AS ALIR_CATCHUP_AVAILABLE_AMT,
NULL                                           AS ALIR_CATCHUP_AVAILABLE_QUALITY_CDE,
NULL                                           AS ALIR_CATCHUP_APPLIED_AMT,
NULL                                           AS ALIR_CATCHUP_APPLIED_QUALITY_CDE,
NULL                                           AS ALIR_CV_DIVIDEND_ADDITIONS_AMT,
NULL                                           AS ALIR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
NULL                                           AS ALIR_CV_PAIDUP_ADDITIONS_AMT,
NULL                                           AS ALIR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL                                           AS ALIR_DIVIDEND_AMT,
NULL                                           AS ALIR_DIVIDEND_QUALITY_CDE,
NULL                                           AS ALIR_DIVIDEND_ADDITIONS_AMT,
NULL                                           AS ALIR_DIVIDEND_ADDITIONS_QUALITY_CDE,
NULL                                           AS ALIR_DIVIDEND_AVAILABLE_AMT,
NULL                                           AS ALIR_DIVIDEND_AVAILABLE_QUALITY_CDE,
NULL                                           AS ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_AMT,
NULL                                           AS ALIR_MODAL_NONUNDERWRITTEN_INCREASE_AVAILABLE_QUALITY_CDE,
NULL                                           AS ALIR_MODAL_PREMIUM_AMT,
NULL                                           AS ALIR_MODAL_PREMIUM_QUALITY_CDE,
NULL                                           AS ALIR_MONTHLY_PREMIUM_AMT,
NULL                                           AS ALIR_MONTHLY_PREMIUM_QUALITY_CDE,
NULL                                           AS ALIR_POLICY_YEAR_NR,
NULL                                           AS ALIR_PAIDUP_ADDITIONS_AMT,
NULL                                           AS ALIR_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL                                           AS ALIR_SCHEDULED_MODAL_PAYMENT_AMT,
NULL                                           AS ALIR_SCHEDULED_MODAL_PAYMENT_QUALITY_CDE,
NULL                                           AS ALIR_SCHEDULED_FRACTIONAL_PAYMENT_AMT,
NULL                                           AS ALIR_SCHEDULED_FRACTIONAL_PAYMENT_QUALITY_CDE,
NULL                                           AS ALIR_UNSCHEDULED_PREMIUM_AMT,
NULL                                           AS ALIR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
NULL                                           AS ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
NULL                                           AS ALIR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
NULL                                           AS ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
NULL                                           AS ALIR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
NULL                                           AS LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_AMT,
NULL                                           AS LISR_CURRENT_DIVIDEND_EARNED_BY_DIVIDENDS_QUALITY_CDE,
NULL                                           AS LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_AMT,
NULL                                           AS LISR_CURRENT_DIVIDEND_EARNED_BY_PREMIUM_PAYMENTS_QUALITY_CDE,
NULL                                           AS CV_PD_ALIR_LISR_AMT,
NULL                                           AS CV_PD_ALIR_LISR_QUALITY_CDE,
NULL                                           AS LISR_CV_DIVIDEND_ADDITIONS_AMT,
NULL                                           AS LISR_CV_DIVIDEND_ADDITIONS_QUALITY_CDE,
NULL                                           AS LISR_CV_PAIDUP_ADDITIONS_AMT,
NULL                                           AS LISR_CV_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL                                           AS LISR_DIVIDEND_AMT,
NULL                                           AS LISR_DIVIDEND_QUALITY_CDE,
NULL                                           AS LISR_DIVIDEND_ADDITIONS_AMT,
NULL                                           AS LISR_DIVIDEND_ADDITIONS_QUALITY_CDE,
NULL                                           AS LISR_DIVIDEND_AVAILABLE_AMT,
NULL                                           AS LISR_DIVIDEND_AVAILABLE_QUALITY_CDE,
NULL                                           AS LISR_PAIDUP_ADDITIONS_AMT,
NULL                                           AS LISR_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL                                           AS LISR_ANNUAL_PREMIUM_AMT,
NULL                                           AS LISR_ANNUAL_PREMIUM_QUALITY_CDE,
NULL                                           AS LISR_FACE_AMT,
NULL                                           AS LISR_FACE_QUALITY_CDE,
NULL                                           AS LISR_MONTHLY_PREMIUM_AMT,
NULL                                           AS LISR_MONTHLY_PREMIUM_QUALITY_CDE,
NULL                                           AS LISR_MODAL_PREMIUM_AMT,
NULL                                           AS LISR_MODAL_PREMIUM_QUALITY_CDE,
NULL                                           AS LISR_RECOMMENDED_PREMIUM_AMT,
NULL                                           AS LISR_RECOMMENDED_PREMIUM_QUALITY_CDE,
NULL                                           AS LISR_UNSCHEDULED_PREMIUM_AMT,
NULL                                           AS LISR_UNSCHEDULED_PREMIUM_QUALITY_CDE,
NULL                                           AS LTC_PREMIUM_ADJUSTMENT_CDE,
NULL                                           AS LTC_ACTIVE_CDE,
NULL                                           AS LTC_ADVANCED_BASE_PAIDUP_ADDITIONS_CDE,
NULL                                           AS LTC_DIVIDENDS_BENEFIT_POOL_AMT,
NULL                                           AS LTC_DIVIDENDS_BENEFIT_POOL_QUALITY_CDE,
NULL                                           AS LTC_RETURN_PREMIUM_AMT,
NULL                                           AS LTC_RETURN_PREMIUM_QUALITY_CDE,
NULL                                           AS LTC_REDUCED_PAIDUP_ADDITIONS_AMT,
NULL                                           AS LTC_REDUCED_PAIDUP_ADDITIONS_QUALITY_CDE,
NULL                                           AS LTC_CURRENT_MODAL_PREMIUM_CREDIT_AMT,
NULL                                           AS LTC_CURRENT_MODAL_PREMIUM_CREDIT_QUALITY_CDE,
NULL                                           AS LTC_FRACTIONAL_PREMIUM_CREDIT_QUALITY_CDE,
NULL                                           AS LTC_FRACTIONAL_PREMIUM_CREDIT_AMT,
NULL                                           AS LTC_CURRENT_MMB_AMT,
NULL                                           AS LTC_CURRENT_MMB_QUALITY_CDE,
NULL                                           AS LTC_BASE_BENEFIT_POOL_AMT,
NULL                                           AS LTC_BASE_BENEFIT_POOL_QUALITY_CDE,
NULL                                           AS LTC_INITIAL_MMB_AMT,
NULL                                           AS LTC_INITIAL_MMB_QUALITY_CDE,
NULL                                           AS LTC_MMB_INCREASE_OPTION_IND,
NULL                                           AS LTC_MMB_INCREASE_AMT,
NULL                                           AS LTC_MMB_INCREASE_QUALITY_CDE,
NULL                                           AS LTC_NEXT_MMB_INCREASE_DT,
NULL                                           AS LTC_NEXT_YEAR_PREMIUM_CREDIT_AMT,
NULL                                           AS LTC_NEXT_YEAR_PREMIUM_CREDIT_QUALITY_CDE,
NULL                                           AS LTC_RESIDUAL_DEATH_BENEFIT_AMT,
NULL                                           AS LTC_RESIDUAL_DEATH_BENEFIT_QUALITY_CDE,
NULL                                           AS LTC_SELECTED_BENEFIT_PERIOD_NR,
NULL                                           AS LTC_CLAIM_START_DT,
NULL                                           AS PAIDUP_ADDITIONS_FACE_AMT,
NULL                                           AS PAIDUP_ADDITIONS_FACE_QUALITY_CDE,
NULL                                           AS SL100_SL20P_POLICY_IND,
NULL                                           AS PALIR_MAX_ANNUAL_PAYMENT_AMT,
NULL                                           AS PALIR_MAX_ANNUAL_PAYMENT_QUALITY_CDE,
NULL                                           AS PALIR_PREMIUM_START_DT,
NULL                                           AS PALIR_PREMIUM_END_DT,
NULL                                           AS PALIR_YTD_PREMIUM_PAID_AMT,
NULL                                           AS PALIR_YTD_PREMIUM_PAID_QUALITY_CDE,
NULL                                           AS PALIR_PREVIOUS_YEAR_PAYMENT_AMT,
NULL                                           AS PALIR_PREVIOUS_YEAR_PAYMENT_QUALITY_CDE,
NULL                                           AS PALIR_ANNUAL_PAYMENT_CNT,
AGMT_VAL.TRANS_DT::DATE				           AS begin_dt,
AGMT_VAL.TRANS_DT::TIMESTAMP   				   AS begin_dtm,
CURRENT_TIMESTAMP(6) 						   AS ROW_PROCESS_DTM,
266                                            AS SOURCE_SYSTEM_ID,
AGMT_VAL.SRC_DEL_IND::BOOLEAN 				   AS SOURCE_DELETE_IND,
AGMT_VAL.RUN_ID        					       AS AUDIT_ID,
AGMT_VAL.UPDT_RUN_ID        				   AS UPDATE_AUDIT_ID,
AGMT_VAL.CURR_IND                              AS CURRENT_ROW_IND,
CASE WHEN AGMT_VAL.CURR_IND='N'THEN AGMT_VAL.TRANS_DT::DATE
WHEN AGMT_VAL.CURR_IND='Y' THEN '9999-12-31'::DATE 
ELSE '9999-12-31'::DATE 
END AS END_DT,
CASE WHEN AGMT_VAL.CURR_IND='N'THEN (AGMT_VAL.TRANS_DT + INTERVAL '1' DAY) - INTERVAL '1' SECOND
WHEN AGMT_VAL.CURR_IND='Y' THEN '9999-12-31'::TIMESTAMP 
ELSE '9999-12-31'::TIMESTAMP                       
END AS END_DTM,
FALSE                                          AS RESTRICTED_ROW_IND,
FALSE                                          AS LOGICAL_DELETE_IND,
NULL AS CREDITING_RT,
NULL AS CREDITING_RT_START_DT,
NULL AS CREDITING_RT_END_DT,
NULL AS CREDITING_REST_PERIOD_DESC,
NULL AS GROSS_NET_CDE,
NULL AS END_DT_BOOK_VAL_AMT,
NULL AS END_DT_MARKET_VAL_AMT,
NULL AS NEXT_MONTH_FIRST_BUSINESS_DAY_DT,
NULL AS NEXT_BUSINESS_DAY_CREDITING_RT
FROM  prod_stnd_vw_tersun.agmt_val_data_vw_aif_rps AGMT_VAL
where src_sys_id=72
and extract(year from trans_dt)>=2019 
) STG;

